function lmInput(){return{scope:{bindModel:"=ngModel",datatype:"@"},require:"ngModel",transclude:!0,templateUrl:"/app/control/input/input-control.html",link:function(t,e,n,o){"use strict";t.datatype||(t.datatype="text")}}}!function(){"use strict";function t(t){t.activeTab="/",t.$on("$routeChangeStart",function(e,n){n.$$route&&(t.activeTab=n.$$route.originalPath)})}function e(t,e){t.otherwise({redirectTo:"/"}),e.html5Mode(!0)}function n(t,e,n){t.$on("$routeChangeSuccess",function(){n.ga&&n.ga("send","pageview",{page:e.path()})})}function o(t){function e(e){var n,o=$(".menu-indicator"),i=$("li.active-menu").index();n=t.tabs[e.index],i>e.index?(o.removeClass("right"),o.addClass("left"),o.css({left:n.left}),o.css({right:n.right})):(o.removeClass("left"),o.addClass("right"),o.css({right:n.right}),o.css({left:n.left}))}t.$on("$routeChangeSuccess",function(n,o){var i=$("menu ul").width();$("menu ul li").each(function(n,o){var r=$(o).outerWidth(),l=t.tabs[n];if(l.index=n,0===n)l.left=0,l.right=i-r;else{var u=t.tabs[n-1];l.left=i-u.right,l.right=u.right-r}t.activeTab.indexOf(l.id)>-1&&e(l)})}),t.tabs=[new i("/","Все"),new i("/film","Фильмы"),new i("/serial","Сериалы"),new i("/anime","Аниме"),new i("/other","Прочее"),new i("/upload","Загрузить фильм")],t.selectTab=e}function i(t,e,n){this.id=t,this.name=e,this.selected=n}angular.module("App",["ngRoute","ngAnimate","app.auth","ContentModule","ControlsModule","ContentCardModule","ItemModule","UploadModule","ProfileModule","RecentModule"]).config(e).run(t).run(n).controller("NavigationCtrl",o),t.$inject=["$rootScope"],e.$inject=["$routeProvider","$locationProvider"],n.$inject=["$rootScope","$location","$window"],o.$inject=["$scope"],i.prototype={id:"",name:"",selected:!1},angular.module("App").directive("background",function(){return function(t,e,n){var o=n.background;e.css({"background-image":"url("+o+")","background-size":"cover"})}})}(),function(){"use strict";angular.module("app.auth",["ngRoute","ngResource","ngCookies","ControlsModule"])}(),function(){function t(t){"ngInject";t.when("/",{templateUrl:"/app/content/content.html",controller:"AllContentCtrl"}).when("/film",{templateUrl:"/app/content/content.html",controller:"FilmContentCtrl"}).when("/serial",{templateUrl:"/app/content/content.html",controller:"SerialContentCtrl"})}function e(t,e){t.content=e.findContent()}function n(t,e){t.content=e.findContent(null,"Film")}function o(t,e){t.content=e.findContent(null,"Serial")}t.$inject=["$routeProvider"],angular.module("ContentModule",["ContentServices"]).config(t).controller("AllContentCtrl",e).controller("SerialContentCtrl",o).controller("FilmContentCtrl",n),e.$inject=["$scope","ContentService"],n.$inject=["$scope","ContentService"],o.$inject=["$scope","ContentService"]}(),angular.module("UploadModule",["ngResource","ngFileUpload","ngCookies"]),function(){"use strict";function t(t,e,n){function o(e,n){t.login(e,n)}var i=this;i.email="Braidner",i.password="12345",i.auth=o,n.$on("oauth:login",function(n){console.log(t.isAuthenticated),t.isAuthenticated&&e.path("/")})}angular.module("app.auth").controller("LoginController",t),t.$inject=["AuthService","$location","$scope"]}(),function(){"use strict";function t(t){t.when("/login",{templateUrl:"/app/auth/login.html"})}function e(t,e,n){t.$on("$routeChangeStart",function(t,o,i){console.log(n.isAuthenticated+" : "+o.$$route.originalPath),n.isAuthenticated||"/login"==o.$$route.originalPath||(t.preventDefault(),console.log("need auth"),e.path("/login"))})}angular.module("app.auth").run(e).config(t),t.$inject=["$routeProvider"],e.$inject=["$rootScope","$location","AuthService"]}(),function(){function t(t,e,n,o,i){function r(r,u){t.auth(n({scope:"ui",username:r,password:u,grant_type:"password"})).$promise.then(function(t){e.defaults.headers.common.Authorization="Bearer "+t.access_token,o.put("access_token",t.access_token),l.isAuthenticated=!0,i.$broadcast("oauth:login",t),console.log(t)},function(){l.isAuthenticated=!1,i.$emit("oauth:login")})}var l=this;return l.isAuthenticated=!1,l.login=r,l}function e(t){return t("/api/auth/:path/:token",{},{auth:{method:"POST",params:{path:"oauth",token:"token"},isArray:!1,headers:{Authorization:"Basic YnJvd3Nlcjo=","Content-type":"application/x-www-form-urlencoded; charset=utf-8"}}})}angular.module("app.auth").factory("AuthService",t).factory("AuthResource",e),t.$inject=["AuthResource","$http","$httpParamSerializer","$cookies","$rootScope"],e.$inject=["$resource"]}(),function(){"use strict";function t(t){return t("api/content/{id}")}angular.module("ContentModule").factory("ContentResource",t),t.$inject=["$resource"]}(),function(){"use strict";function t(t){function e(t,e){return i.query({name:t,type:e})}function n(t){t.type="film";var e=new i(t);return e.$save(),e}var o=this,i=t("/api/content/resource",{},{});return o.findContent=e,o.createContent=n,o}angular.module("ContentServices",["ngResource"]).factory("ContentService",t),t.$inject=["$resource"]}(),function(){function t(t){"ngInject";t.when("/film/:content_id",{templateUrl:"/app/content-card/content-card.html",controller:"FilmCardCtrl"}).when("/serial/:content_id",{templateUrl:"/app/content-card/content-card.html",controller:"SerialCardCtrl"})}function e(){"ngInject"}function n(){"ngInject"}t.$inject=["$routeProvider"],angular.module("ContentCardModule",[]),angular.module("ContentCardModule").config(t).controller("FilmCardCtrl",e).controller("SerialCardCtrl",n)}(),function(){"use strict";angular.module("ControlsModule",["control.input-control","control.parser","control.input-chunk"])}(),function(){function t(t){"ngInject";function e(e,n,o){n.on("click",function(n){t.path("/"+angular.lowercase(e.item.type)+"/"+e.item.id),e.$apply()})}return{link:e,restrict:"E",replace:!0,scope:{item:"="},templateUrl:"/app/item/item.html"}}angular.module("ItemModule",[]).directive("contentItem",t),t.$inject=["$location"]}(),function(){"use strict";function t(t){"ngInject";t.when("/profile",{templateUrl:"/app/profile/profile.html",controller:"ProfileCtrl"})}function e(t){function e(t){return profile.perms.indexOf(t)>-1}t.profile={login:"Braidner",perms:["user:edit:profile"]},t.hasPermission=e}function n(){}t.$inject=["$routeProvider"],e.$inject=["$rootScope"],angular.module("ProfileModule",[]),angular.module("ProfileModule").config(t),angular.module("ProfileModule").run(e),angular.module("ProfileModule").controller("ProfileCtrl",n)}(),function(){"use strict";function t(t){t.content=[{name:"Zootopia",poster:"http://www.kinopoisk.ru/images/film_big/775276.jpg",id:0,type:"film"},{name:"Batman v Superman: Dawn of Justice",poster:"http://www.kinopoisk.ru/images/film_big/770631.jpg",id:0,type:"film"},{name:"The Justice League Part One",poster:"http://www.kinopoisk.ru/images/film_big/424994.jpg",id:0,type:"film"},{name:"The flash",poster:"http://www.kinopoisk.ru/images/film_big/817506.jpg",id:0,type:"film"},{name:"The Justice League Part One",poster:"http://www.kinopoisk.ru/images/film_big/424994.jpg",id:0,type:"film"},{name:"Frozen",poster:"http://www.kinopoisk.ru/images/film_big/493208.jpg",id:0,type:"film"},{name:"Batman v Superman: Dawn of Justice",poster:"http://www.kinopoisk.ru/images/film_big/770631.jpg",id:0,type:"film"},{name:"Untitled Spider-Man Reboot",poster:"http://www.kinopoisk.ru/images/film_big/690593.jpg",id:0,type:"film"}]}angular.module("RecentModule",[]).controller("RecentCtrl",t),t.$inject=["$scope"],angular.module("RecentModule").directive("owlCarousel",function(){var t=function(t,e,n){var o=function(){e.owlCarousel({loop:!1,nav:!1,responsive:{1200:{items:6},992:{items:4},768:{items:3},479:{items:2}}})};t.$watchCollection(n.owlCarousel,function(){o()})};return{restrict:"A",link:t}})}(),function(){"use strict";function t(t,e,n){function o(){console.log(i.content),i.content.type="film",i.uploadFile.upload=n.upload({url:"/api/content/resource",data:{content:JSON.stringify(r),file:i.uploadFile}}),i.uploadFile.upload.then(function(t){i.uploadFile.result=t.data},function(t){t.status>0&&console.log(t.status+": "+t.data)},function(t){i.uploadFile.progress=Math.min(100,parseInt(100*t.loaded/t.total)),console.log("Progress: "+Math.min(100,parseInt(100*t.loaded/t.total)))})}var i=this;i.uploadFile={},i.content={},i.save=o;var r=t.get();t.set(null),r&&(i.content=r)}angular.module("UploadModule").controller("UploadCtrl",t),t.$inject=["UploadData","ContentService","Upload","$cookies"]}(),function(){"use strict";function t(){function t(t){n=t}function e(){return n}var n={};return{set:t,get:e}}angular.module("UploadModule").factory("UploadData",t)}(),function(){"use strict";function t(t){t.when("/upload",{templateUrl:"/app/upload/upload.html"})}angular.module("UploadModule").config(t),t.$inject=["$routeProvider"]}(),function(){"use strict";function t(t,e){function n(){var n=t.get(),o=new e(n);return o.id}var o=this;return o.createContent=n,o}angular.module("UploadModule").service("UploadService",t),t.$inject=["UploadData","ContentResource"]}(),angular.module("control.input-control",[]).directive("lmInput",lmInput),function(){function t(){return{scope:{bindModel:"=ngModel"},require:"ngModel",transclude:!0,templateUrl:"/app/control/input-chunk/input-chunk.html",link:function(t,e,n,o){"use strict"}}}angular.module("control.input-chunk",[]),angular.module("control.input-chunk").directive("lmInputChunk",t)}(),function(){function t(t,e,n){return{scope:{bindModel:"=ngModel"},require:"ngModel",transclude:!0,templateUrl:"/app/control/url-parser-control/url-parser-control.html",link:function(o,i,r,l){"use strict";i.find(".button").on("click",function(){n.get({id:o.bindModel.match(/\/film\/(\d*)\//)[1]}).$promise.then(function(n){n.url=o.bindModel,e.set(n),t.path("/upload")})})}}}function e(t){return t("/api/content/discovery/:id")}angular.module("control.parser",["ngResource"]),angular.module("ControlsModule").directive("lmUrlParser",t).factory("DiscoveryResource",e),t.$inject=["$location","UploadData","DiscoveryResource"],e.$inject=["$resource"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRyb2wvaW5wdXQvSW5wdXRDb250cm9sLmpzIiwiYXBwLm1vZHVsZS5qcyIsImF1dGgvYXV0aC5tb2R1bGUuanMiLCJjb250ZW50L2NvbnRlbnQubW9kdWxlLmpzIiwiYWxsLm1pbi5qcyIsInVwbG9hZC91cGxvYWQubW9kdWxlLmpzIiwiYXV0aC9hdXRoLmNvbnRyb2xsZXIuanMiLCJhdXRoL2F1dGgucm91dGUuanMiLCJhdXRoL2F1dGguc2VydmljZS5qcyIsImNvbnRlbnQvY29udGVudC5yZXNvdXJjZS5qcyIsImNvbnRlbnQvY29udGVudC5zZXJ2aWNlLmpzIiwiY29udGVudC1jYXJkL0NvbnRlbnRDYXJkTW9kdWxlLmpzIiwiY29udHJvbC9Db250cm9sc01vZHVsZS5qcyIsIml0ZW0vSXRlbU1vZHVsZS5qcyIsInByb2ZpbGUvUHJvZmlsZU1vZHVsZS5qcyIsInJlY2VudC9SZWNlbnRNb2R1bGUuanMiLCJ1cGxvYWQvdXBsb2FkLmNvbnRyb2xsZXIuanMiLCJ1cGxvYWQvdXBsb2FkLnJlc291cmNlLmpzIiwidXBsb2FkL3VwbG9hZC5yb3V0ZS5qcyIsInVwbG9hZC91cGxvYWQuc2VydmljZS5qcyIsImNvbnRyb2wvaW5wdXQtY2h1bmsvaW5wdXRDaHVuay5qcyIsImNvbnRyb2wvdXJsLXBhcnNlci1jb250cm9sL3VybFBhcnNlckNvbnRyb2wuanMiXSwibmFtZXMiOlsibG1JbnB1dCIsInNjb3BlIiwiYmluZE1vZGVsIiwiZGF0YXR5cGUiLCJyZXF1aXJlIiwidHJhbnNjbHVkZSIsInRlbXBsYXRlVXJsIiwibGluayIsImVsZW0iLCJhdHRyIiwibmdNb2RlbCIsIk1vbml0b3JDb25maWciLCIkcm9vdFNjb3BlIiwiYWN0aXZlVGFiIiwiJG9uIiwiZXZlbnQiLCJuZXh0IiwiJCRyb3V0ZSIsIm9yaWdpbmFsUGF0aCIsIlJvdXRlQ29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJodG1sNU1vZGUiLCJBbmFseXRpY3NDb25maWciLCIkbG9jYXRpb24iLCIkd2luZG93IiwiZ2EiLCJwYWdlIiwicGF0aCIsIk5hdmlnYXRpb25DdHJsIiwiJHNjb3BlIiwic2VsZWN0VGFiIiwidGFiIiwic2VsZWN0ZWRUYWIiLCJpbmRpY2F0b3IiLCIkIiwiaW5kZXgiLCJ0YWJzIiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsImNzcyIsImxlZnQiLCJyaWdodCIsImN1cnJlbnQiLCJ0b3RhbFdpZHRoIiwid2lkdGgiLCJlYWNoIiwiZWwiLCJvdXRlcldpZHRoIiwibGFzdFRhYiIsImluZGV4T2YiLCJpZCIsIlRhYiIsIm5hbWUiLCJzZWxlY3RlZCIsInRoaXMiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwicnVuIiwiY29udHJvbGxlciIsIiRpbmplY3QiLCJwcm90b3R5cGUiLCJkaXJlY3RpdmUiLCJlbGVtZW50IiwiYXR0cnMiLCJ1cmwiLCJiYWNrZ3JvdW5kIiwiYmFja2dyb3VuZC1pbWFnZSIsImJhY2tncm91bmQtc2l6ZSIsIndoZW4iLCJBbGxDb250ZW50Q3RybCIsIkNvbnRlbnRTZXJ2aWNlIiwiY29udGVudCIsImZpbmRDb250ZW50IiwiRmlsbUNvbnRlbnRDdHJsIiwiU2VyaWFsQ29udGVudEN0cmwiLCJMb2dpbkNvbnRyb2xsZXIiLCJBdXRoU2VydmljZSIsImF1dGgiLCJsb2dpbiIsInBhc3N3b3JkIiwic2VsZiIsImVtYWlsIiwidG9rZW4iLCJjb25zb2xlIiwibG9nIiwiaXNBdXRoZW50aWNhdGVkIiwiUm91dGVJbnRlcmNlcHRvciIsInByZXZlbnREZWZhdWx0IiwiQXV0aFJlc291cmNlIiwiJGh0dHAiLCIkaHR0cFBhcmFtU2VyaWFsaXplciIsIiRjb29raWVzIiwidXNlcm5hbWUiLCJncmFudF90eXBlIiwiJHByb21pc2UiLCJ0aGVuIiwiZGF0YSIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsIkF1dGhvcml6YXRpb24iLCJhY2Nlc3NfdG9rZW4iLCJwdXQiLCIkYnJvYWRjYXN0IiwiJGVtaXQiLCIkcmVzb3VyY2UiLCJtZXRob2QiLCJwYXJhbXMiLCJpc0FycmF5IiwiQ29udGVudC10eXBlIiwiZmFjdG9yeSIsIkNvbnRlbnRSZXNvdXJjZSIsInR5cGUiLCJDb250ZW50IiwicXVlcnkiLCJjcmVhdGVDb250ZW50IiwiY29udGVudERhdGEiLCIkc2F2ZSIsIkZpbG1DYXJkQ3RybCIsIlNlcmlhbENhcmRDdHJsIiwiY29udGVudEl0ZW0iLCJsaW5rZXIiLCJvbiIsImxvd2VyY2FzZSIsIml0ZW0iLCIkYXBwbHkiLCJyZXN0cmljdCIsInJlcGxhY2UiLCJQcm9maWxlQ29uZmlnIiwiaGFzUGVybWlzc2lvbiIsInBlcm0iLCJwcm9maWxlIiwicGVybXMiLCJQcm9maWxlQ3RybCIsIlJlY2VudEN0cmwiLCJwb3N0ZXIiLCJsb2FkQ2Fyb3VzZWwiLCJvd2xDYXJvdXNlbCIsImxvb3AiLCJuYXYiLCJyZXNwb25zaXZlIiwiMTIwMCIsIml0ZW1zIiwiOTkyIiwiNzY4IiwiNDc5IiwiJHdhdGNoQ29sbGVjdGlvbiIsIlVwbG9hZEN0cmwiLCJVcGxvYWREYXRhIiwiVXBsb2FkIiwic2F2ZSIsInVwbG9hZEZpbGUiLCJ1cGxvYWQiLCJKU09OIiwic3RyaW5naWZ5IiwiZmlsZSIsInJlc3BvbnNlIiwicmVzdWx0Iiwic3RhdHVzIiwiZXZ0IiwicHJvZ3Jlc3MiLCJNYXRoIiwibWluIiwicGFyc2VJbnQiLCJsb2FkZWQiLCJ0b3RhbCIsImdldCIsInNldCIsInVwbG9hZERhdGEiLCJVcGxvYWRTZXJ2aWNlIiwiY3JlYXRlZENvbnRlbnQiLCJzZXJ2aWNlIiwiaW5wdXRDaHVuayIsImxtVXJsUGFyc2VyIiwiRGlzY292ZXJ5UmVzb3VyY2UiLCJmaW5kIiwibWF0Y2giLCJyZXNwb25jZSJdLCJtYXBwaW5ncyI6IkFBUUEsUUFBQUEsV0FDQSxPQUNBQyxPQUNBQyxVQUFBLFdBQ0FDLFNBQUEsS0FFQUMsUUFBQSxVQUNBQyxZQUFBLEVBQ0FDLFlBQUEsd0NBQ0FDLEtBQUEs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QUEsMEJBQ0FELFFBQUFDLE9BQUEsdUJBQ0FNLFVBQUEsZUFBQStHLE1DQUEsV0FRQSxRQUFBQyxHQUFBdkosRUFBQThILEVBQUEwQixHQUNBLE9BQ0FqTCxPQUNBQyxVQUFBLFlBRUFFLFFBQUEsVUFFQUMsWUFBQSxFQUNBQyxZQUFBLDBEQUNBQyxLQUFBLFNBQUFOLEVBQUFPLEVBQUFDLEVBQUFDLEdBQ0EsWUFDQUYsR0FBQTJLLEtBQUEsV0FBQXJELEdBQUEsUUFBQSxXQUNBb0QsRUFBQVIsS0FBQXJILEdBQUFwRCxFQUFBQyxVQUFBa0wsTUFBQSxtQkFBQSxLQUNBbEYsU0FBQUMsS0FBQSxTQUFBa0YsR0FDQUEsRUFBQWpILElBQUFuRSxFQUFBQyxVQUNBc0osRUFBQW1CLElBQUFVLEdBQ0EzSixFQUFBSSxLQUFBLGlCQVFBLFFBQUFvSixHQUFBckUsR0FDQSxNQUFBQSxHQUFBLDhCQWhDQW5ELFFBQUFDLE9BQUEsa0JBQUEsZUFFQUQsUUFBQUMsT0FBQSxrQkFDQU0sVUFBQSxjQUFBZ0gsR0FDQS9ELFFBQUEsb0JBQUFnRSxHQUVBRCxFQUFBbEgsU0FBQSxZQUFBLGFBQUEscUJBd0JBbUgsRUFBQW5ILFNBQUEiLCJmaWxlIjoiYWxsLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGdvb2RsIG9uIDQvMi8yMDE2LlxyXG4gKi9cclxuXHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnY29udHJvbC5pbnB1dC1jb250cm9sJywgW10pXHJcbiAgICAuZGlyZWN0aXZlKCdsbUlucHV0JywgbG1JbnB1dCk7XHJcblxyXG5mdW5jdGlvbiBsbUlucHV0KCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBzY29wZToge1xyXG4gICAgICAgICAgICBiaW5kTW9kZWw6Jz1uZ01vZGVsJyxcclxuICAgICAgICAgICAgZGF0YXR5cGU6ICdAJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxyXG4gICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXHJcbiAgICAgICAgJ3RlbXBsYXRlVXJsJzogJy9hcHAvY29udHJvbC9pbnB1dC9pbnB1dC1jb250cm9sLmh0bWwnLFxyXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbSwgYXR0ciwgbmdNb2RlbCkge1xyXG4gICAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICAgICAgaWYgKCFzY29wZS5kYXRhdHlwZSkge1xyXG4gICAgICAgICAgICAgICAgc2NvcGUuZGF0YXR5cGUgPSAndGV4dCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gZWxlbS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBlbGVtLmFkZENsYXNzKCdsbS1pbnB1dC1mb2N1c2VkJyk7XHJcbiAgICAgICAgICAgIC8vIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn0iLCIvKipcbiAqIENyZWF0ZWQgYnkgQnJhaWRuZXIgb24gMzAvMDEvMjAxNi5cbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnQXBwJywgW1xuICAgICAgICAnbmdSb3V0ZScsXG4gICAgICAgICduZ0FuaW1hdGUnLFxuXG4gICAgICAgIC8vTW9kdWxlc1xuICAgICAgICAnYXBwLmF1dGgnLFxuICAgICAgICAnQ29udGVudE1vZHVsZScsXG4gICAgICAgICdDb250cm9sc01vZHVsZScsXG4gICAgICAgICdDb250ZW50Q2FyZE1vZHVsZScsXG4gICAgICAgICdJdGVtTW9kdWxlJyxcbiAgICAgICAgJ1VwbG9hZE1vZHVsZScsXG4gICAgICAgICdQcm9maWxlTW9kdWxlJyxcbiAgICAgICAgJ1JlY2VudE1vZHVsZSdcbiAgICBdKVxuICAgICAgICAuY29uZmlnKFJvdXRlQ29uZmlnKVxuICAgICAgICAucnVuKE1vbml0b3JDb25maWcpXG4gICAgICAgIC5ydW4oQW5hbHl0aWNzQ29uZmlnKVxuICAgICAgICAuY29udHJvbGxlcihcIk5hdmlnYXRpb25DdHJsXCIsIE5hdmlnYXRpb25DdHJsKTtcblxuICAgIE1vbml0b3JDb25maWcuJGluamVjdCA9IFsnJHJvb3RTY29wZSddO1xuICAgIGZ1bmN0aW9uIE1vbml0b3JDb25maWcoJHJvb3RTY29wZSkge1xuICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVRhYiA9IFwiL1wiO1xuICAgICAgICAkcm9vdFNjb3BlLiRvbignJHJvdXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbiAoZXZlbnQsIG5leHQpIHtcbiAgICAgICAgICAgIC8vVE9ETyBhZGQgbW9uaXRvcmluZ1xuICAgICAgICAgICAgaWYgKG5leHQuJCRyb3V0ZSkge1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlVGFiID0gbmV4dC4kJHJvdXRlLm9yaWdpbmFsUGF0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgUm91dGVDb25maWcuJGluamVjdCA9IFsnJHJvdXRlUHJvdmlkZXInLCAnJGxvY2F0aW9uUHJvdmlkZXInXTtcbiAgICBmdW5jdGlvbiBSb3V0ZUNvbmZpZygkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcbiAgICAgICAgJHJvdXRlUHJvdmlkZXIub3RoZXJ3aXNlKHtcbiAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvJ1xuICAgICAgICB9KTtcbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuICAgIH1cblxuICAgIEFuYWx5dGljc0NvbmZpZy4kaW5qZWN0ID0gWyckcm9vdFNjb3BlJywgJyRsb2NhdGlvbicsICckd2luZG93J107XG4gICAgZnVuY3Rpb24gQW5hbHl0aWNzQ29uZmlnKCRyb290U2NvcGUsICRsb2NhdGlvbiwgJHdpbmRvdykge1xuICAgICAgICAkcm9vdFNjb3BlLiRvbignJHJvdXRlQ2hhbmdlU3VjY2VzcycsXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEkd2luZG93LmdhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHdpbmRvdy5nYSgnc2VuZCcsICdwYWdldmlldycsIHtcbiAgICAgICAgICAgICAgICAgICAgcGFnZTogJGxvY2F0aW9uLnBhdGgoKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cblxuICAgIE5hdmlnYXRpb25DdHJsLiRpbmplY3QgPSBbJyRzY29wZSddO1xuICAgIGZ1bmN0aW9uIE5hdmlnYXRpb25DdHJsICgkc2NvcGUpIHtcbiAgICAgICAgJHNjb3BlLiRvbignJHJvdXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uIChldmVudCwgY3VycmVudCkge1xuICAgICAgICAgICAgdmFyIHRvdGFsV2lkdGggPSAkKCdtZW51IHVsJykud2lkdGgoKTtcbiAgICAgICAgICAgICQoXCJtZW51IHVsIGxpXCIpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBlbCkge1xuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9ICQoZWwpLm91dGVyV2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgdGFiID0gJHNjb3BlLnRhYnNbaW5kZXhdO1xuICAgICAgICAgICAgICAgIHRhYi5pbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0YWIubGVmdCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHRhYi5yaWdodCA9IHRvdGFsV2lkdGggLSB3aWR0aDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGFzdFRhYiA9ICRzY29wZS50YWJzW2luZGV4IC0gMV07XG4gICAgICAgICAgICAgICAgICAgIHRhYi5sZWZ0ID0gdG90YWxXaWR0aCAtIGxhc3RUYWIucmlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIHRhYi5yaWdodCA9IGxhc3RUYWIucmlnaHQgLSB3aWR0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hY3RpdmVUYWIuaW5kZXhPZih0YWIuaWQpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0VGFiKHRhYik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS50YWJzID0gW1xuICAgICAgICAgICAgbmV3IFRhYihcIi9cIiwgXCLQktGB0LVcIiksXG4gICAgICAgICAgICBuZXcgVGFiKFwiL2ZpbG1cIiwgXCLQpNC40LvRjNC80YtcIiksXG4gICAgICAgICAgICBuZXcgVGFiKFwiL3NlcmlhbFwiLCBcItCh0LXRgNC40LDQu9GLXCIpLFxuICAgICAgICAgICAgbmV3IFRhYihcIi9hbmltZVwiLCBcItCQ0L3QuNC80LVcIiksXG4gICAgICAgICAgICBuZXcgVGFiKFwiL290aGVyXCIsIFwi0J/RgNC+0YfQtdC1XCIpLFxuICAgICAgICAgICAgbmV3IFRhYihcIi91cGxvYWRcIiwgXCLQl9Cw0LPRgNGD0LfQuNGC0Ywg0YTQuNC70YzQvFwiKVxuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgJHNjb3BlLnNlbGVjdFRhYiA9IHNlbGVjdFRhYjtcblxuICAgICAgICBmdW5jdGlvbiBzZWxlY3RUYWIodGFiKSB7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRUYWI7XG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9yID0gJCgnLm1lbnUtaW5kaWNhdG9yJyk7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSAkKCdsaS5hY3RpdmUtbWVudScpLmluZGV4KCk7XG5cbiAgICAgICAgICAgIHNlbGVjdGVkVGFiID0gJHNjb3BlLnRhYnNbdGFiLmluZGV4XTtcbiAgICAgICAgICAgIGlmIChpbmRleCA+IHRhYi5pbmRleCkge1xuICAgICAgICAgICAgICAgIGluZGljYXRvci5yZW1vdmVDbGFzcyhcInJpZ2h0XCIpO1xuICAgICAgICAgICAgICAgIGluZGljYXRvci5hZGRDbGFzcyhcImxlZnRcIik7XG4gICAgICAgICAgICAgICAgaW5kaWNhdG9yLmNzcyh7bGVmdDogc2VsZWN0ZWRUYWIubGVmdH0pO1xuICAgICAgICAgICAgICAgIGluZGljYXRvci5jc3Moe3JpZ2h0OiBzZWxlY3RlZFRhYi5yaWdodH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbmRpY2F0b3IucmVtb3ZlQ2xhc3MoXCJsZWZ0XCIpO1xuICAgICAgICAgICAgICAgIGluZGljYXRvci5hZGRDbGFzcyhcInJpZ2h0XCIpO1xuICAgICAgICAgICAgICAgIGluZGljYXRvci5jc3Moe3JpZ2h0OiBzZWxlY3RlZFRhYi5yaWdodH0pO1xuICAgICAgICAgICAgICAgIGluZGljYXRvci5jc3Moe2xlZnQ6IHNlbGVjdGVkVGFiLmxlZnR9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIFRhYihpZCwgbmFtZSwgc2VsZWN0ZWQpIHtcbiAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLnNlbGVjdGVkID0gc2VsZWN0ZWQ7XG4gICAgfVxuXG4gICAgVGFiLnByb3RvdHlwZSA9IHtcbiAgICAgICAgaWQ6IFwiXCIsXG4gICAgICAgIG5hbWU6IFwiXCIsXG4gICAgICAgIHNlbGVjdGVkOiBmYWxzZVxuICAgIH07XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnQXBwJykuZGlyZWN0aXZlKCdiYWNrZ3JvdW5kJywgZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycyl7XG4gICAgICAgICAgICB2YXIgdXJsID0gYXR0cnMuYmFja2dyb3VuZDtcbiAgICAgICAgICAgIGVsZW1lbnQuY3NzKHtcbiAgICAgICAgICAgICAgICAnYmFja2dyb3VuZC1pbWFnZSc6ICd1cmwoJyArIHVybCArJyknLFxuICAgICAgICAgICAgICAgICdiYWNrZ3JvdW5kLXNpemUnIDogJ2NvdmVyJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgfSk7XG5cblxuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICBcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAuYXV0aCcsIFsnbmdSb3V0ZScsICduZ1Jlc291cmNlJywgJ25nQ29va2llcycsICdDb250cm9sc01vZHVsZSddKTtcclxufSkoKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBnb29kbCBvbiAzLzkvMjAxNi5cclxuICovXHJcblxyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgYW5ndWxhci5tb2R1bGUoJ0NvbnRlbnRNb2R1bGUnLCBbJ0NvbnRlbnRTZXJ2aWNlcyddKVxyXG4gICAgICAgIC5jb25maWcoUm91dGVDb25maWcpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0FsbENvbnRlbnRDdHJsJywgQWxsQ29udGVudEN0cmwpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1NlcmlhbENvbnRlbnRDdHJsJywgU2VyaWFsQ29udGVudEN0cmwpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0ZpbG1Db250ZW50Q3RybCcsIEZpbG1Db250ZW50Q3RybCk7XHJcblxyXG4gICAgZnVuY3Rpb24gUm91dGVDb25maWcoJHJvdXRlUHJvdmlkZXIpIHtcclxuICAgICAgICBcIm5nSW5qZWN0XCI7XHJcbiAgICAgICAgJHJvdXRlUHJvdmlkZXIud2hlbignLycsIHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXBwL2NvbnRlbnQvY29udGVudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0FsbENvbnRlbnRDdHJsJ1xyXG4gICAgICAgIH0pLndoZW4oJy9maWxtJywge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hcHAvY29udGVudC9jb250ZW50Lmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnRmlsbUNvbnRlbnRDdHJsJ1xyXG4gICAgICAgIH0pLndoZW4oJy9zZXJpYWwnLCB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2FwcC9jb250ZW50L2NvbnRlbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZXJpYWxDb250ZW50Q3RybCdcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBBbGxDb250ZW50Q3RybC4kaW5qZWN0ID0gWyckc2NvcGUnLCAnQ29udGVudFNlcnZpY2UnXTtcclxuICAgIGZ1bmN0aW9uIEFsbENvbnRlbnRDdHJsKCRzY29wZSwgQ29udGVudFNlcnZpY2UpIHtcclxuICAgICAgICAkc2NvcGUuY29udGVudCA9IENvbnRlbnRTZXJ2aWNlLmZpbmRDb250ZW50KCk7XHJcbiAgICB9XHJcblxyXG4gICAgRmlsbUNvbnRlbnRDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICdDb250ZW50U2VydmljZSddO1xyXG4gICAgZnVuY3Rpb24gRmlsbUNvbnRlbnRDdHJsKCRzY29wZSwgQ29udGVudFNlcnZpY2UpIHtcclxuICAgICAgICAkc2NvcGUuY29udGVudCA9IENvbnRlbnRTZXJ2aWNlLmZpbmRDb250ZW50KG51bGwsICdGaWxtJyk7XHJcbiAgICB9XHJcblxyXG4gICAgU2VyaWFsQ29udGVudEN0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJ0NvbnRlbnRTZXJ2aWNlJ107XHJcbiAgICBmdW5jdGlvbiBTZXJpYWxDb250ZW50Q3RybCgkc2NvcGUsIENvbnRlbnRTZXJ2aWNlKSB7XHJcbiAgICAgICAgJHNjb3BlLmNvbnRlbnQgPSBDb250ZW50U2VydmljZS5maW5kQ29udGVudChudWxsLCAnU2VyaWFsJyk7XHJcbiAgICB9XHJcbn0pKCk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IEJyYWlkbmVyIG9uIDMwLzAxLzIwMTYuXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ0FwcCcsIFtcbiAgICAgICAgJ25nUm91dGUnLFxuICAgICAgICAnbmdBbmltYXRlJyxcblxuICAgICAgICAvL01vZHVsZXNcbiAgICAgICAgJ2FwcC5hdXRoJyxcbiAgICAgICAgJ0NvbnRlbnRNb2R1bGUnLFxuICAgICAgICAnQ29udHJvbHNNb2R1bGUnLFxuICAgICAgICAnQ29udGVudENhcmRNb2R1bGUnLFxuICAgICAgICAnSXRlbU1vZHVsZScsXG4gICAgICAgICdVcGxvYWRNb2R1bGUnLFxuICAgICAgICAnUHJvZmlsZU1vZHVsZScsXG4gICAgICAgICdSZWNlbnRNb2R1bGUnXG4gICAgXSlcbiAgICAgICAgLmNvbmZpZyhSb3V0ZUNvbmZpZylcbiAgICAgICAgLnJ1bihNb25pdG9yQ29uZmlnKVxuICAgICAgICAucnVuKEFuYWx5dGljc0NvbmZpZylcbiAgICAgICAgLmNvbnRyb2xsZXIoXCJOYXZpZ2F0aW9uQ3RybFwiLCBOYXZpZ2F0aW9uQ3RybCk7XG5cbiAgICBNb25pdG9yQ29uZmlnLiRpbmplY3QgPSBbJyRyb290U2NvcGUnXTtcbiAgICBmdW5jdGlvbiBNb25pdG9yQ29uZmlnKCRyb290U2NvcGUpIHtcbiAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVUYWIgPSBcIi9cIjtcbiAgICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKGV2ZW50LCBuZXh0KSB7XG4gICAgICAgICAgICAvL1RPRE8gYWRkIG1vbml0b3JpbmdcbiAgICAgICAgICAgIGlmIChuZXh0LiQkcm91dGUpIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVRhYiA9IG5leHQuJCRyb3V0ZS5vcmlnaW5hbFBhdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIFJvdXRlQ29uZmlnLiRpbmplY3QgPSBbJyRyb3V0ZVByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJ107XG4gICAgZnVuY3Rpb24gUm91dGVDb25maWcoJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAgICAgICRyb3V0ZVByb3ZpZGVyLm90aGVyd2lzZSh7XG4gICAgICAgICAgICByZWRpcmVjdFRvOiAnLydcbiAgICAgICAgfSk7XG4gICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcbiAgICB9XG5cbiAgICBBbmFseXRpY3NDb25maWcuJGluamVjdCA9IFsnJHJvb3RTY29wZScsICckbG9jYXRpb24nLCAnJHdpbmRvdyddO1xuICAgIGZ1bmN0aW9uIEFuYWx5dGljc0NvbmZpZygkcm9vdFNjb3BlLCAkbG9jYXRpb24sICR3aW5kb3cpIHtcbiAgICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN1Y2Nlc3MnLFxuICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmICghJHdpbmRvdy5nYSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICR3aW5kb3cuZ2EoJ3NlbmQnLCAncGFnZXZpZXcnLCB7XG4gICAgICAgICAgICAgICAgICAgIHBhZ2U6ICRsb2NhdGlvbi5wYXRoKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBOYXZpZ2F0aW9uQ3RybC4kaW5qZWN0ID0gWyckc2NvcGUnXTtcbiAgICBmdW5jdGlvbiBOYXZpZ2F0aW9uQ3RybCAoJHNjb3BlKSB7XG4gICAgICAgICRzY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbiAoZXZlbnQsIGN1cnJlbnQpIHtcbiAgICAgICAgICAgIHZhciB0b3RhbFdpZHRoID0gJCgnbWVudSB1bCcpLndpZHRoKCk7XG4gICAgICAgICAgICAkKFwibWVudSB1bCBsaVwiKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWwpIHtcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSAkKGVsKS5vdXRlcldpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHRhYiA9ICRzY29wZS50YWJzW2luZGV4XTtcbiAgICAgICAgICAgICAgICB0YWIuaW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGFiLmxlZnQgPSAwO1xuICAgICAgICAgICAgICAgICAgICB0YWIucmlnaHQgPSB0b3RhbFdpZHRoIC0gd2lkdGg7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RUYWIgPSAkc2NvcGUudGFic1tpbmRleCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICB0YWIubGVmdCA9IHRvdGFsV2lkdGggLSBsYXN0VGFiLnJpZ2h0O1xuICAgICAgICAgICAgICAgICAgICB0YWIucmlnaHQgPSBsYXN0VGFiLnJpZ2h0IC0gd2lkdGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYWN0aXZlVGFiLmluZGV4T2YodGFiLmlkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdFRhYih0YWIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUudGFicyA9IFtcbiAgICAgICAgICAgIG5ldyBUYWIoXCIvXCIsIFwi0JLRgdC1XCIpLFxuICAgICAgICAgICAgbmV3IFRhYihcIi9maWxtXCIsIFwi0KTQuNC70YzQvNGLXCIpLFxuICAgICAgICAgICAgbmV3IFRhYihcIi9zZXJpYWxcIiwgXCLQodC10YDQuNCw0LvRi1wiKSxcbiAgICAgICAgICAgIG5ldyBUYWIoXCIvYW5pbWVcIiwgXCLQkNC90LjQvNC1XCIpLFxuICAgICAgICAgICAgbmV3IFRhYihcIi9vdGhlclwiLCBcItCf0YDQvtGH0LXQtVwiKSxcbiAgICAgICAgICAgIG5ldyBUYWIoXCIvdXBsb2FkXCIsIFwi0JfQsNCz0YDRg9C30LjRgtGMINGE0LjQu9GM0LxcIilcbiAgICAgICAgXTtcbiAgICAgICAgXG4gICAgICAgICRzY29wZS5zZWxlY3RUYWIgPSBzZWxlY3RUYWI7XG5cbiAgICAgICAgZnVuY3Rpb24gc2VsZWN0VGFiKHRhYikge1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkVGFiO1xuICAgICAgICAgICAgdmFyIGluZGljYXRvciA9ICQoJy5tZW51LWluZGljYXRvcicpO1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gJCgnbGkuYWN0aXZlLW1lbnUnKS5pbmRleCgpO1xuXG4gICAgICAgICAgICBzZWxlY3RlZFRhYiA9ICRzY29wZS50YWJzW3RhYi5pbmRleF07XG4gICAgICAgICAgICBpZiAoaW5kZXggPiB0YWIuaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBpbmRpY2F0b3IucmVtb3ZlQ2xhc3MoXCJyaWdodFwiKTtcbiAgICAgICAgICAgICAgICBpbmRpY2F0b3IuYWRkQ2xhc3MoXCJsZWZ0XCIpO1xuICAgICAgICAgICAgICAgIGluZGljYXRvci5jc3Moe2xlZnQ6IHNlbGVjdGVkVGFiLmxlZnR9KTtcbiAgICAgICAgICAgICAgICBpbmRpY2F0b3IuY3NzKHtyaWdodDogc2VsZWN0ZWRUYWIucmlnaHR9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5kaWNhdG9yLnJlbW92ZUNsYXNzKFwibGVmdFwiKTtcbiAgICAgICAgICAgICAgICBpbmRpY2F0b3IuYWRkQ2xhc3MoXCJyaWdodFwiKTtcbiAgICAgICAgICAgICAgICBpbmRpY2F0b3IuY3NzKHtyaWdodDogc2VsZWN0ZWRUYWIucmlnaHR9KTtcbiAgICAgICAgICAgICAgICBpbmRpY2F0b3IuY3NzKHtsZWZ0OiBzZWxlY3RlZFRhYi5sZWZ0fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBUYWIoaWQsIG5hbWUsIHNlbGVjdGVkKSB7XG4gICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9IHNlbGVjdGVkO1xuICAgIH1cblxuICAgIFRhYi5wcm90b3R5cGUgPSB7XG4gICAgICAgIGlkOiBcIlwiLFxuICAgICAgICBuYW1lOiBcIlwiLFxuICAgICAgICBzZWxlY3RlZDogZmFsc2VcbiAgICB9O1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ0FwcCcpLmRpcmVjdGl2ZSgnYmFja2dyb3VuZCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpe1xuICAgICAgICAgICAgdmFyIHVybCA9IGF0dHJzLmJhY2tncm91bmQ7XG4gICAgICAgICAgICBlbGVtZW50LmNzcyh7XG4gICAgICAgICAgICAgICAgJ2JhY2tncm91bmQtaW1hZ2UnOiAndXJsKCcgKyB1cmwgKycpJyxcbiAgICAgICAgICAgICAgICAnYmFja2dyb3VuZC1zaXplJyA6ICdjb3ZlcidcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgIH0pO1xuXG5cblxufSkoKTtcbihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICBcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAuYXV0aCcsIFsnbmdSb3V0ZScsICduZ1Jlc291cmNlJywgJ25nQ29va2llcycsICdDb250cm9sc01vZHVsZSddKTtcclxufSkoKTtcbi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGdvb2RsIG9uIDMvOS8yMDE2LlxyXG4gKi9cclxuXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICBSb3V0ZUNvbmZpZy4kaW5qZWN0ID0gW1wiJHJvdXRlUHJvdmlkZXJcIl07XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnQ29udGVudE1vZHVsZScsIFsnQ29udGVudFNlcnZpY2VzJ10pXHJcbiAgICAgICAgLmNvbmZpZyhSb3V0ZUNvbmZpZylcclxuICAgICAgICAuY29udHJvbGxlcignQWxsQ29udGVudEN0cmwnLCBBbGxDb250ZW50Q3RybClcclxuICAgICAgICAuY29udHJvbGxlcignU2VyaWFsQ29udGVudEN0cmwnLCBTZXJpYWxDb250ZW50Q3RybClcclxuICAgICAgICAuY29udHJvbGxlcignRmlsbUNvbnRlbnRDdHJsJywgRmlsbUNvbnRlbnRDdHJsKTtcclxuXHJcbiAgICBmdW5jdGlvbiBSb3V0ZUNvbmZpZygkcm91dGVQcm92aWRlcikge1xyXG4gICAgICAgIFwibmdJbmplY3RcIjtcclxuICAgICAgICAkcm91dGVQcm92aWRlci53aGVuKCcvJywge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hcHAvY29udGVudC9jb250ZW50Lmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQWxsQ29udGVudEN0cmwnXHJcbiAgICAgICAgfSkud2hlbignL2ZpbG0nLCB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2FwcC9jb250ZW50L2NvbnRlbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdGaWxtQ29udGVudEN0cmwnXHJcbiAgICAgICAgfSkud2hlbignL3NlcmlhbCcsIHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXBwL2NvbnRlbnQvY29udGVudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1NlcmlhbENvbnRlbnRDdHJsJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIEFsbENvbnRlbnRDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICdDb250ZW50U2VydmljZSddO1xyXG4gICAgZnVuY3Rpb24gQWxsQ29udGVudEN0cmwoJHNjb3BlLCBDb250ZW50U2VydmljZSkge1xyXG4gICAgICAgICRzY29wZS5jb250ZW50ID0gQ29udGVudFNlcnZpY2UuZmluZENvbnRlbnQoKTtcclxuICAgIH1cclxuXHJcbiAgICBGaWxtQ29udGVudEN0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJ0NvbnRlbnRTZXJ2aWNlJ107XHJcbiAgICBmdW5jdGlvbiBGaWxtQ29udGVudEN0cmwoJHNjb3BlLCBDb250ZW50U2VydmljZSkge1xyXG4gICAgICAgICRzY29wZS5jb250ZW50ID0gQ29udGVudFNlcnZpY2UuZmluZENvbnRlbnQobnVsbCwgJ0ZpbG0nKTtcclxuICAgIH1cclxuXHJcbiAgICBTZXJpYWxDb250ZW50Q3RybC4kaW5qZWN0ID0gWyckc2NvcGUnLCAnQ29udGVudFNlcnZpY2UnXTtcclxuICAgIGZ1bmN0aW9uIFNlcmlhbENvbnRlbnRDdHJsKCRzY29wZSwgQ29udGVudFNlcnZpY2UpIHtcclxuICAgICAgICAkc2NvcGUuY29udGVudCA9IENvbnRlbnRTZXJ2aWNlLmZpbmRDb250ZW50KG51bGwsICdTZXJpYWwnKTtcclxuICAgIH1cclxufSkoKTtcbi8qKlxyXG4gKiBDcmVhdGVkIGJ5IFVzZXIgb24gMTUuMDYuMjAxNi5cclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdVcGxvYWRNb2R1bGUnLCBbJ25nUmVzb3VyY2UnLCAnbmdGaWxlVXBsb2FkJywgJ25nQ29va2llcyddKTtcclxuXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5hdXRoJykuY29udHJvbGxlcignTG9naW5Db250cm9sbGVyJywgTG9naW5Db250cm9sbGVyKTtcclxuXHJcbiAgICBMb2dpbkNvbnRyb2xsZXIuJGluamVjdCA9IFsnQXV0aFNlcnZpY2UnLCBcIiRsb2NhdGlvblwiLCAnJHNjb3BlJ107XHJcbiAgICBmdW5jdGlvbiBMb2dpbkNvbnRyb2xsZXIoQXV0aFNlcnZpY2UsICRsb2NhdGlvbiwgJHNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHNlbGYuZW1haWwgPSAnQnJhaWRuZXInO1xyXG4gICAgICAgIHNlbGYucGFzc3dvcmQgPSAnMTIzNDUnO1xyXG5cclxuICAgICAgICBzZWxmLmF1dGggPSBhdXRoO1xyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdvYXV0aDpsb2dpbicsIGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQpO1xyXG4gICAgICAgICAgICBpZiAoQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGF1dGgobG9naW4sIHBhc3N3b3JkKSB7XHJcbiAgICAgICAgICAgIEF1dGhTZXJ2aWNlLmxvZ2luKGxvZ2luLCBwYXNzd29yZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KSgpO1xuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLmF1dGgnKVxyXG4gICAgICAgIC5ydW4oUm91dGVJbnRlcmNlcHRvcilcclxuICAgICAgICAuY29uZmlnKFJvdXRlQ29uZmlnKTtcclxuXHJcbiAgICBSb3V0ZUNvbmZpZy4kaW5qZWN0ID0gWyckcm91dGVQcm92aWRlciddO1xyXG4gICAgZnVuY3Rpb24gUm91dGVDb25maWcoJHJvdXRlUHJvdmlkZXIpIHtcclxuICAgICAgICAkcm91dGVQcm92aWRlci53aGVuKCcvbG9naW4nLCB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2FwcC9hdXRoL2xvZ2luLmh0bWwnXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgUm91dGVJbnRlcmNlcHRvci4kaW5qZWN0ID0gWyckcm9vdFNjb3BlJywgJyRsb2NhdGlvbicsICdBdXRoU2VydmljZSddO1xyXG4gICAgZnVuY3Rpb24gUm91dGVJbnRlcmNlcHRvcigkcm9vdFNjb3BlLCAkbG9jYXRpb24sIEF1dGhTZXJ2aWNlKSB7XHJcbiAgICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKGV2ZW50LCBuZXh0LCBjdXJyZW50KSB7XHJcbiAgICAgICAgICAgIC8vanNoaW50IGRlYnVnOiB0cnVlXHJcbiAgICAgICAgICAgIGRlYnVnZ2VyO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQgKyAnIDogJyArIG5leHQuJCRyb3V0ZS5vcmlnaW5hbFBhdGgpO1xyXG4gICAgICAgICAgICBpZiAoIUF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCAmJiBuZXh0LiQkcm91dGUub3JpZ2luYWxQYXRoICE9ICcvbG9naW4nKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbmVlZCBhdXRoJyk7XHJcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2xvZ2luJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSkoKTtcbihmdW5jdGlvbiAoKSB7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLmF1dGgnKVxyXG4gICAgICAgIC5mYWN0b3J5KCdBdXRoU2VydmljZScsIEF1dGhTZXJ2aWNlKVxyXG4gICAgICAgIC5mYWN0b3J5KCdBdXRoUmVzb3VyY2UnLCBBdXRoUmVzb3VyY2UpO1xyXG5cclxuICAgIEF1dGhTZXJ2aWNlLiRpbmplY3QgPSBbJ0F1dGhSZXNvdXJjZScsICckaHR0cCcsICckaHR0cFBhcmFtU2VyaWFsaXplcicsICckY29va2llcycsICckcm9vdFNjb3BlJ107XHJcbiAgICBmdW5jdGlvbiBBdXRoU2VydmljZShBdXRoUmVzb3VyY2UsICRodHRwLCAkaHR0cFBhcmFtU2VyaWFsaXplciwgJGNvb2tpZXMsICRyb290U2NvcGUpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICAgIHNlbGYuaXNBdXRoZW50aWNhdGVkID0gZmFsc2U7XHJcbiAgICAgICAgc2VsZi5sb2dpbiA9IGxvZ2luO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBsb2dpbihlbWFpbCwgcGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgQXV0aFJlc291cmNlLmF1dGgoJGh0dHBQYXJhbVNlcmlhbGl6ZXIoXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGU6ICd1aScsXHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IGVtYWlsLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZCxcclxuICAgICAgICAgICAgICAgICAgICBncmFudF90eXBlOiAncGFzc3dvcmQnXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICkpLiRwcm9taXNlLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uLkF1dGhvcml6YXRpb24gPSAnQmVhcmVyICcgKyBkYXRhLmFjY2Vzc190b2tlbjtcclxuICAgICAgICAgICAgICAgICRjb29raWVzLnB1dChcImFjY2Vzc190b2tlblwiLCBkYXRhLmFjY2Vzc190b2tlbik7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmlzQXV0aGVudGljYXRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ29hdXRoOmxvZ2luJywgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5pc0F1dGhlbnRpY2F0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJ29hdXRoOmxvZ2luJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHNlbGY7XHJcbiAgICB9XHJcblxyXG4gICAgQXV0aFJlc291cmNlLiRpbmplY3QgPSBbJyRyZXNvdXJjZSddO1xyXG4gICAgZnVuY3Rpb24gQXV0aFJlc291cmNlKCRyZXNvdXJjZSkge1xyXG4gICAgICAgIHJldHVybiAkcmVzb3VyY2UoJy9hcGkvYXV0aC86cGF0aC86dG9rZW4nLCB7fSwge1xyXG4gICAgICAgICAgICAnYXV0aCc6IHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLCBwYXJhbXM6IHtwYXRoOiAnb2F1dGgnLCB0b2tlbjogJ3Rva2VuJ30sIGlzQXJyYXk6IGZhbHNlLCBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiAnQmFzaWMgWW5KdmQzTmxjam89JyxcclxuICAgICAgICAgICAgICAgICAgICAnQ29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD11dGYtOCdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59KSgpO1xuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdDb250ZW50TW9kdWxlJykuZmFjdG9yeSgnQ29udGVudFJlc291cmNlJywgQ29udGVudFJlc291cmNlKTtcclxuXHJcbiAgICBDb250ZW50UmVzb3VyY2UuJGluamVjdCA9IFsnJHJlc291cmNlJ107XHJcbiAgICBmdW5jdGlvbiBDb250ZW50UmVzb3VyY2UoJHJlc291cmNlKSB7XHJcbiAgICAgICAgcmV0dXJuICRyZXNvdXJjZSgnYXBpL2NvbnRlbnQve2lkfScpO1xyXG4gICAgfVxyXG59KSgpO1xuLyoqXHJcbiAqIENyZWF0ZWQgYnkgZ29vZGwgb24gMy85LzIwMTYuXHJcbiAqL1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnQ29udGVudFNlcnZpY2VzJywgWyduZ1Jlc291cmNlJ10pXHJcbiAgICAgICAgLmZhY3RvcnkoJ0NvbnRlbnRTZXJ2aWNlJywgQ29udGVudFNlcnZpY2UpO1xyXG5cclxuICAgIENvbnRlbnRTZXJ2aWNlLiRpbmplY3QgPSBbJyRyZXNvdXJjZSddO1xyXG4gICAgZnVuY3Rpb24gQ29udGVudFNlcnZpY2UoJHJlc291cmNlKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBDb250ZW50ID0gJHJlc291cmNlKCcvYXBpL2NvbnRlbnQvcmVzb3VyY2UnLCB7fSwge30pO1xyXG4gICAgICAgIHNlbGYuZmluZENvbnRlbnQgPSBmaW5kQ29udGVudDtcclxuICAgICAgICBzZWxmLmNyZWF0ZUNvbnRlbnQgPSBjcmVhdGVDb250ZW50O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBmaW5kQ29udGVudChuYW1lLCB0eXBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBDb250ZW50LnF1ZXJ5KHtuYW1lOiBuYW1lLCB0eXBlOiB0eXBlfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVDb250ZW50KGNvbnRlbnREYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnRlbnREYXRhLnR5cGUgPSAnZmlsbSc7XHJcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gbmV3IENvbnRlbnQoY29udGVudERhdGEpO1xyXG4gICAgICAgICAgICBjb250ZW50LiRzYXZlKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBjb250ZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gc2VsZjtcclxuICAgIH1cclxufSkoKTtcclxuXG4vKipcclxuICogQ3JlYXRlZCBieSBnb29kbCBvbiAzLzEzLzIwMTYuXHJcbiAqL1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgUm91dGVDb25maWcuJGluamVjdCA9IFtcIiRyb3V0ZVByb3ZpZGVyXCJdO1xyXG4gICAgYW5ndWxhci5tb2R1bGUoJ0NvbnRlbnRDYXJkTW9kdWxlJywgW10pO1xyXG4gICAgXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnQ29udGVudENhcmRNb2R1bGUnKVxyXG4gICAgICAgIC5jb25maWcoUm91dGVDb25maWcpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0ZpbG1DYXJkQ3RybCcsIEZpbG1DYXJkQ3RybClcclxuICAgICAgICAuY29udHJvbGxlcignU2VyaWFsQ2FyZEN0cmwnLCBTZXJpYWxDYXJkQ3RybCk7XHJcblxyXG4gICAgZnVuY3Rpb24gUm91dGVDb25maWcoJHJvdXRlUHJvdmlkZXIpIHtcclxuICAgICAgICBcIm5nSW5qZWN0XCI7XHJcbiAgICAgICAgJHJvdXRlUHJvdmlkZXIud2hlbignL2ZpbG0vOmNvbnRlbnRfaWQnLCB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2FwcC9jb250ZW50LWNhcmQvY29udGVudC1jYXJkLmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnRmlsbUNhcmRDdHJsJ1xyXG4gICAgICAgIH0pLndoZW4oJy9zZXJpYWwvOmNvbnRlbnRfaWQnLCB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2FwcC9jb250ZW50LWNhcmQvY29udGVudC1jYXJkLmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU2VyaWFsQ2FyZEN0cmwnXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gRmlsbUNhcmRDdHJsKCkge1xyXG4gICAgICAgIFwibmdJbmplY3RcIjtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBTZXJpYWxDYXJkQ3RybCgpIHtcclxuICAgICAgICBcIm5nSW5qZWN0XCI7XHJcbiAgICB9XHJcbiAgICBcclxufSkoKTtcbi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGdvb2RsIG9uIDQvMi8yMDE2LlxyXG4gKi9cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ0NvbnRyb2xzTW9kdWxlJywgW1xyXG4gICAgICAgICdjb250cm9sLmlucHV0LWNvbnRyb2wnLCBcclxuICAgICAgICAnY29udHJvbC5wYXJzZXInLFxyXG4gICAgICAgICdjb250cm9sLmlucHV0LWNodW5rJ1xyXG4gICAgXSk7XHJcbn0pKCk7XG4vKipcclxuICogQ3JlYXRlZCBieSBnb29kbCBvbiAzLzkvMjAxNi5cclxuICovXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnSXRlbU1vZHVsZScsIFtdKVxyXG4gICAgICAgIC5kaXJlY3RpdmUoJ2NvbnRlbnRJdGVtJywgY29udGVudEl0ZW0pO1xyXG5cclxuICAgIGNvbnRlbnRJdGVtLiRpbmplY3QgPSBbJyRsb2NhdGlvbiddO1xyXG4gICAgZnVuY3Rpb24gY29udGVudEl0ZW0oJGxvY2F0aW9uKSB7XHJcbiAgICAgICAgXCJuZ0luamVjdFwiO1xyXG4gICAgICAgIGZ1bmN0aW9uIGxpbmtlcihzY29wZSwgZWxlbWVudCwgYXR0cikge1xyXG4gICAgICAgICAgICBlbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIgKyBhbmd1bGFyLmxvd2VyY2FzZShzY29wZS5pdGVtLnR5cGUpICtcIi9cIiArIHNjb3BlLml0ZW0uaWQpO1xyXG4gICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBsaW5rOiBsaW5rZXIsXHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICAgICAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtOiAnPSdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXBwL2l0ZW0vaXRlbS5odG1sJ1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn0pKCk7XG4vKipcclxuICogQ3JlYXRlZCBieSBnb29kbCBvbiAzLzIxLzIwMTYuXHJcbiAqL1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgXHJcbiAgICBSb3V0ZUNvbmZpZy4kaW5qZWN0ID0gW1wiJHJvdXRlUHJvdmlkZXJcIl07XHJcbiAgICBQcm9maWxlQ29uZmlnLiRpbmplY3QgPSBbXCIkcm9vdFNjb3BlXCJdO1xyXG4gICAgYW5ndWxhci5tb2R1bGUoJ1Byb2ZpbGVNb2R1bGUnLCBbXSk7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnUHJvZmlsZU1vZHVsZScpLmNvbmZpZyhSb3V0ZUNvbmZpZyk7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnUHJvZmlsZU1vZHVsZScpLnJ1bihQcm9maWxlQ29uZmlnKTtcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdQcm9maWxlTW9kdWxlJykuY29udHJvbGxlcignUHJvZmlsZUN0cmwnLCBQcm9maWxlQ3RybCk7XHJcblxyXG4gICAgZnVuY3Rpb24gUm91dGVDb25maWcoJHJvdXRlUHJvdmlkZXIpIHtcclxuICAgICAgICBcIm5nSW5qZWN0XCI7XHJcbiAgICAgICAgJHJvdXRlUHJvdmlkZXIud2hlbignL3Byb2ZpbGUnLCB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2FwcC9wcm9maWxlL3Byb2ZpbGUuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlQ3RybCdcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZnVuY3Rpb24gUHJvZmlsZUNvbmZpZygkcm9vdFNjb3BlKSB7XHJcbiAgICAgICAgJHJvb3RTY29wZS5wcm9maWxlID0ge2xvZ2luOiBcIkJyYWlkbmVyXCIsIHBlcm1zOiBbJ3VzZXI6ZWRpdDpwcm9maWxlJ119O1xyXG4gICAgICAgICRyb290U2NvcGUuaGFzUGVybWlzc2lvbiA9IGhhc1Blcm1pc3Npb247XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGhhc1Blcm1pc3Npb24ocGVybSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcHJvZmlsZS5wZXJtcy5pbmRleE9mKHBlcm0pID4gLTE7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIFByb2ZpbGVDdHJsKCkge1xyXG4gICAgfVxyXG4gICAgXHJcbn0pKCk7XG4vKipcclxuICogQ3JlYXRlZCBieSBCcmFpZG5lclxyXG4gKi9cclxuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnUmVjZW50TW9kdWxlJywgW10pXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoXCJSZWNlbnRDdHJsXCIsIFJlY2VudEN0cmwpO1xyXG5cclxuICAgIFJlY2VudEN0cmwuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcbiAgICBmdW5jdGlvbiBSZWNlbnRDdHJsKCRzY29wZSkge1xyXG4gICAgICAgICRzY29wZS5jb250ZW50ID0gW1xyXG4gICAgICAgICAgICB7bmFtZTogJ1pvb3RvcGlhJywgcG9zdGVyOiAnaHR0cDovL3d3dy5raW5vcG9pc2sucnUvaW1hZ2VzL2ZpbG1fYmlnLzc3NTI3Ni5qcGcnLCBpZDogMCwgdHlwZTogJ2ZpbG0nfSxcclxuICAgICAgICAgICAge25hbWU6ICdCYXRtYW4gdiBTdXBlcm1hbjogRGF3biBvZiBKdXN0aWNlJywgcG9zdGVyOiAnaHR0cDovL3d3dy5raW5vcG9pc2sucnUvaW1hZ2VzL2ZpbG1fYmlnLzc3MDYzMS5qcGcnLCBpZDogMCwgdHlwZTogJ2ZpbG0nfSxcclxuICAgICAgICAgICAge25hbWU6ICdUaGUgSnVzdGljZSBMZWFndWUgUGFydCBPbmUnLCBwb3N0ZXI6ICdodHRwOi8vd3d3Lmtpbm9wb2lzay5ydS9pbWFnZXMvZmlsbV9iaWcvNDI0OTk0LmpwZycsIGlkOiAwLCB0eXBlOiAnZmlsbSd9LFxyXG4gICAgICAgICAgICB7bmFtZTogJ1RoZSBmbGFzaCcsIHBvc3RlcjogJ2h0dHA6Ly93d3cua2lub3BvaXNrLnJ1L2ltYWdlcy9maWxtX2JpZy84MTc1MDYuanBnJywgaWQ6IDAsIHR5cGU6ICdmaWxtJ30sXHJcbiAgICAgICAgICAgIHtuYW1lOiAnVGhlIEp1c3RpY2UgTGVhZ3VlIFBhcnQgT25lJywgcG9zdGVyOiAnaHR0cDovL3d3dy5raW5vcG9pc2sucnUvaW1hZ2VzL2ZpbG1fYmlnLzQyNDk5NC5qcGcnLCBpZDogMCwgdHlwZTogJ2ZpbG0nfSxcclxuICAgICAgICAgICAge25hbWU6ICdGcm96ZW4nLCBwb3N0ZXI6ICdodHRwOi8vd3d3Lmtpbm9wb2lzay5ydS9pbWFnZXMvZmlsbV9iaWcvNDkzMjA4LmpwZycsIGlkOiAwLCB0eXBlOiAnZmlsbSd9LFxyXG4gICAgICAgICAgICB7bmFtZTogJ0JhdG1hbiB2IFN1cGVybWFuOiBEYXduIG9mIEp1c3RpY2UnLCBwb3N0ZXI6ICdodHRwOi8vd3d3Lmtpbm9wb2lzay5ydS9pbWFnZXMvZmlsbV9iaWcvNzcwNjMxLmpwZycsIGlkOiAwLCB0eXBlOiAnZmlsbSd9LFxyXG4gICAgICAgICAgICB7bmFtZTogJ1VudGl0bGVkIFNwaWRlci1NYW4gUmVib290JywgcG9zdGVyOiAnaHR0cDovL3d3dy5raW5vcG9pc2sucnUvaW1hZ2VzL2ZpbG1fYmlnLzY5MDU5My5qcGcnLCBpZDogMCwgdHlwZTogJ2ZpbG0nfVxyXG4gICAgICAgIF07XHJcbiAgICB9XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ1JlY2VudE1vZHVsZScpLmRpcmVjdGl2ZSgnb3dsQ2Fyb3VzZWwnLCBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIHZhciBsaW5rZXIgPSBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBsb2FkQ2Fyb3VzZWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50Lm93bENhcm91c2VsKFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9vcDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hdjogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNpdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEyMDA6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtczogNlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDk5Mjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zOiA0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgNzY4OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IDNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA0Nzk6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtczogMlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHNjb3BlLiR3YXRjaENvbGxlY3Rpb24oYXR0ci5vd2xDYXJvdXNlbCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgbG9hZENhcm91c2VsKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogXCJBXCIsXHJcbiAgICAgICAgICAgIGxpbms6IGxpbmtlclxyXG4gICAgICAgIH07XHJcblxyXG4gICAgfSk7XHJcbn0pKCk7XG4vKipcclxuICogQ3JlYXRlZCBieSBVc2VyIG9uIDE1LjA2LjIwMTYuXHJcbiAqL1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgYW5ndWxhci5tb2R1bGUoJ1VwbG9hZE1vZHVsZScpLmNvbnRyb2xsZXIoJ1VwbG9hZEN0cmwnLCBVcGxvYWRDdHJsKTtcclxuXHJcbiAgICBVcGxvYWRDdHJsLiRpbmplY3QgPSBbJ1VwbG9hZERhdGEnLCAnQ29udGVudFNlcnZpY2UnLCAnVXBsb2FkJywgJyRjb29raWVzJ107XHJcbiAgICBmdW5jdGlvbiBVcGxvYWRDdHJsKFVwbG9hZERhdGEsIENvbnRlbnRTZXJ2aWNlLCBVcGxvYWQpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgc2VsZi51cGxvYWRGaWxlID0ge307XHJcbiAgICAgICAgc2VsZi5jb250ZW50ID0ge307XHJcbiAgICAgICAgc2VsZi5zYXZlID0gc2F2ZTtcclxuICAgICAgICB2YXIgY29udGVudCA9IFVwbG9hZERhdGEuZ2V0KCk7XHJcbiAgICAgICAgVXBsb2FkRGF0YS5zZXQobnVsbCk7XHJcbiAgICAgICAgaWYgKGNvbnRlbnQpIHtcclxuICAgICAgICAgICAgc2VsZi5jb250ZW50ID0gY29udGVudDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNhdmUoKSB7XHJcbiAgICAgICAgICAgIC8vanNoaW50IGRlYnVnOiB0cnVlXHJcbiAgICAgICAgICAgIGRlYnVnZ2VyO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxmLmNvbnRlbnQpO1xyXG4gICAgICAgICAgICBzZWxmLmNvbnRlbnQudHlwZSA9ICdmaWxtJztcclxuXHJcbiAgICAgICAgICAgIHNlbGYudXBsb2FkRmlsZS51cGxvYWQgPSBVcGxvYWQudXBsb2FkKHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9hcGkvY29udGVudC9yZXNvdXJjZScsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7Y29udGVudDogSlNPTi5zdHJpbmdpZnkoY29udGVudCksIGZpbGU6IHNlbGYudXBsb2FkRmlsZX1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBzZWxmLnVwbG9hZEZpbGUudXBsb2FkLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnVwbG9hZEZpbGUucmVzdWx0ID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID4gMClcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5zdGF0dXMgKyAnOiAnICsgcmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgICAgICAgICAgIC8vIE1hdGgubWluIGlzIHRvIGZpeCBJRSB3aGljaCByZXBvcnRzIDIwMCUgc29tZXRpbWVzXHJcbiAgICAgICAgICAgICAgICBzZWxmLnVwbG9hZEZpbGUucHJvZ3Jlc3MgPSBNYXRoLm1pbigxMDAsIHBhcnNlSW50KDEwMC4wICogZXZ0LmxvYWRlZCAvIGV2dC50b3RhbCkpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1Byb2dyZXNzOiAnICsgTWF0aC5taW4oMTAwLCBwYXJzZUludCgxMDAuMCAqIGV2dC5sb2FkZWQgLyBldnQudG90YWwpKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvLyBDb250ZW50U2VydmljZS5jcmVhdGVDb250ZW50KHNlbGYuY29udGVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KSgpO1xuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIFxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ1VwbG9hZE1vZHVsZScpXHJcbiAgICAgICAgLmZhY3RvcnkoJ1VwbG9hZERhdGEnLCBVcGxvYWREYXRhKTtcclxuXHJcbiAgICBmdW5jdGlvbiBVcGxvYWREYXRhKCkge1xyXG4gICAgICAgIHZhciB1cGxvYWREYXRhID0ge307XHJcbiAgICAgICAgZnVuY3Rpb24gc2V0KGRhdGEpIHtcclxuICAgICAgICAgICAgdXBsb2FkRGF0YSA9IGRhdGE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGdldCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHVwbG9hZERhdGE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzZXQ6IHNldCxcclxuICAgICAgICAgICAgZ2V0OiBnZXRcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgXHJcbn0pKCk7XG4vKipcclxuICogQ3JlYXRlZCBieSBVc2VyIG9uIDE1LjA2LjIwMTYuXHJcbiAqL1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgYW5ndWxhci5tb2R1bGUoJ1VwbG9hZE1vZHVsZScpLmNvbmZpZyhSb3V0ZUNvbmZpZyk7XHJcblxyXG4gICAgUm91dGVDb25maWcuJGluamVjdCA9IFsnJHJvdXRlUHJvdmlkZXInXTtcclxuICAgIGZ1bmN0aW9uIFJvdXRlQ29uZmlnKCRyb3V0ZVByb3ZpZGVyKSB7XHJcbiAgICAgICAgJHJvdXRlUHJvdmlkZXIud2hlbignL3VwbG9hZCcsIHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXBwL3VwbG9hZC91cGxvYWQuaHRtbCdcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG59KSgpO1xuLyoqXHJcbiAqIENyZWF0ZWQgYnkgVXNlciBvbiAxNS4wNi4yMDE2LlxyXG4gKi9cclxuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdVcGxvYWRNb2R1bGUnKS5zZXJ2aWNlKCdVcGxvYWRTZXJ2aWNlJywgVXBsb2FkU2VydmljZSk7XHJcblxyXG4gICAgVXBsb2FkU2VydmljZS4kaW5qZWN0ID0gWydVcGxvYWREYXRhJywgJ0NvbnRlbnRSZXNvdXJjZSddO1xyXG4gICAgZnVuY3Rpb24gVXBsb2FkU2VydmljZSh1cGxvYWREYXRhLCBDb250ZW50UmVzb3VyY2UpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICAgIHNlbGYuY3JlYXRlQ29udGVudCA9IGNyZWF0ZUNvbnRlbnQ7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUNvbnRlbnQoKSB7XHJcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gdXBsb2FkRGF0YS5nZXQoKTtcclxuICAgICAgICAgICAgdmFyIGNyZWF0ZWRDb250ZW50ID0gbmV3IENvbnRlbnRSZXNvdXJjZShjb250ZW50KTtcclxuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZWRDb250ZW50LmlkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHNlbGY7XHJcbiAgICB9XHJcbn0pKCk7XG4vKipcclxuICogQ3JlYXRlZCBieSBnb29kbCBvbiA0LzIvMjAxNi5cclxuICovXHJcblxyXG5cclxuYW5ndWxhci5tb2R1bGUoJ2NvbnRyb2wuaW5wdXQtY29udHJvbCcsIFtdKVxyXG4gICAgLmRpcmVjdGl2ZSgnbG1JbnB1dCcsIGxtSW5wdXQpO1xyXG5cclxuZnVuY3Rpb24gbG1JbnB1dCgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgc2NvcGU6IHtcclxuICAgICAgICAgICAgYmluZE1vZGVsOic9bmdNb2RlbCcsXHJcbiAgICAgICAgICAgIGRhdGF0eXBlOiAnQCdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcclxuICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxyXG4gICAgICAgICd0ZW1wbGF0ZVVybCc6ICcvYXBwL2NvbnRyb2wvaW5wdXQvaW5wdXQtY29udHJvbC5odG1sJyxcclxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW0sIGF0dHIsIG5nTW9kZWwpIHtcclxuICAgICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgICAgIGlmICghc2NvcGUuZGF0YXR5cGUpIHtcclxuICAgICAgICAgICAgICAgIHNjb3BlLmRhdGF0eXBlID0gJ3RleHQnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGVsZW0ub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyAgICAgZWxlbS5hZGRDbGFzcygnbG0taW5wdXQtZm9jdXNlZCcpO1xyXG4gICAgICAgICAgICAvLyB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XG4oZnVuY3Rpb24gKCkge1xyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2NvbnRyb2wuaW5wdXQtY2h1bmsnLCBbXSk7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnY29udHJvbC5pbnB1dC1jaHVuaycpXHJcbiAgICAgICAgLmRpcmVjdGl2ZSgnbG1JbnB1dENodW5rJywgaW5wdXRDaHVuayk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgZnVuY3Rpb24gaW5wdXRDaHVuaygpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzY29wZToge1xyXG4gICAgICAgICAgICAgICAgYmluZE1vZGVsOic9bmdNb2RlbCdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxyXG4gICAgICAgICAgICAvLyByZXBsYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxyXG4gICAgICAgICAgICAndGVtcGxhdGVVcmwnOiAnL2FwcC9jb250cm9sL2lucHV0LWNodW5rL2lucHV0LWNodW5rLmh0bWwnLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW0sIGF0dHIsIG5nTW9kZWwpIHtcclxuICAgICAgICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufSkoKTtcbi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEt1em5ldHNvdk5FIG9uIDA0LjA0LjIwMTYuXHJcbiAqL1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2NvbnRyb2wucGFyc2VyJywgWyduZ1Jlc291cmNlJ10pO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdDb250cm9sc01vZHVsZScpXHJcbiAgICAgICAgLmRpcmVjdGl2ZSgnbG1VcmxQYXJzZXInLCBsbVVybFBhcnNlcilcclxuICAgICAgICAuZmFjdG9yeSgnRGlzY292ZXJ5UmVzb3VyY2UnLCBEaXNjb3ZlcnlSZXNvdXJjZSk7XHJcblxyXG4gICAgbG1VcmxQYXJzZXIuJGluamVjdCA9IFsnJGxvY2F0aW9uJywgJ1VwbG9hZERhdGEnLCAnRGlzY292ZXJ5UmVzb3VyY2UnXTtcclxuICAgIGZ1bmN0aW9uIGxtVXJsUGFyc2VyKCRsb2NhdGlvbiwgVXBsb2FkRGF0YSwgRGlzY292ZXJ5UmVzb3VyY2UpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzY29wZToge1xyXG4gICAgICAgICAgICAgICAgYmluZE1vZGVsOic9bmdNb2RlbCdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxyXG4gICAgICAgICAgICAvLyByZXBsYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxyXG4gICAgICAgICAgICAndGVtcGxhdGVVcmwnOiAnL2FwcC9jb250cm9sL3VybC1wYXJzZXItY29udHJvbC91cmwtcGFyc2VyLWNvbnRyb2wuaHRtbCcsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbSwgYXR0ciwgbmdNb2RlbCkge1xyXG4gICAgICAgICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgICAgICAgICBlbGVtLmZpbmQoJy5idXR0b24nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgRGlzY292ZXJ5UmVzb3VyY2UuZ2V0KHtpZDogc2NvcGUuYmluZE1vZGVsLm1hdGNoKC9cXC9maWxtXFwvKFxcZCopXFwvLylbMV19KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuJHByb21pc2UudGhlbihmdW5jdGlvbiAocmVzcG9uY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uY2UudXJsID0gc2NvcGUuYmluZE1vZGVsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBVcGxvYWREYXRhLnNldChyZXNwb25jZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvdXBsb2FkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgRGlzY292ZXJ5UmVzb3VyY2UuJGluamVjdCA9IFsnJHJlc291cmNlJ107XHJcbiAgICBmdW5jdGlvbiBEaXNjb3ZlcnlSZXNvdXJjZSgkcmVzb3VyY2UpIHtcclxuICAgICAgICByZXR1cm4gJHJlc291cmNlKCcvYXBpL2NvbnRlbnQvZGlzY292ZXJ5LzppZCcpO1xyXG4gICAgfVxyXG5cclxufSkoKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBVc2VyIG9uIDE1LjA2LjIwMTYuXHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnVXBsb2FkTW9kdWxlJywgWyduZ1Jlc291cmNlJywgJ25nRmlsZVVwbG9hZCcsICduZ0Nvb2tpZXMnXSk7XHJcbiIsIihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLmF1dGgnKS5jb250cm9sbGVyKCdMb2dpbkNvbnRyb2xsZXInLCBMb2dpbkNvbnRyb2xsZXIpO1xyXG5cclxuICAgIExvZ2luQ29udHJvbGxlci4kaW5qZWN0ID0gWydBdXRoU2VydmljZScsIFwiJGxvY2F0aW9uXCIsICckc2NvcGUnXTtcclxuICAgIGZ1bmN0aW9uIExvZ2luQ29udHJvbGxlcihBdXRoU2VydmljZSwgJGxvY2F0aW9uLCAkc2NvcGUpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgc2VsZi5lbWFpbCA9ICdCcmFpZG5lcic7XHJcbiAgICAgICAgc2VsZi5wYXNzd29yZCA9ICcxMjM0NSc7XHJcblxyXG4gICAgICAgIHNlbGYuYXV0aCA9IGF1dGg7XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ29hdXRoOmxvZ2luJywgZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKEF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCk7XHJcbiAgICAgICAgICAgIGlmIChBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQpIHtcclxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYXV0aChsb2dpbiwgcGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgQXV0aFNlcnZpY2UubG9naW4obG9naW4sIHBhc3N3b3JkKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLmF1dGgnKVxyXG4gICAgICAgIC5ydW4oUm91dGVJbnRlcmNlcHRvcilcclxuICAgICAgICAuY29uZmlnKFJvdXRlQ29uZmlnKTtcclxuXHJcbiAgICBSb3V0ZUNvbmZpZy4kaW5qZWN0ID0gWyckcm91dGVQcm92aWRlciddO1xyXG4gICAgZnVuY3Rpb24gUm91dGVDb25maWcoJHJvdXRlUHJvdmlkZXIpIHtcclxuICAgICAgICAkcm91dGVQcm92aWRlci53aGVuKCcvbG9naW4nLCB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2FwcC9hdXRoL2xvZ2luLmh0bWwnXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgUm91dGVJbnRlcmNlcHRvci4kaW5qZWN0ID0gWyckcm9vdFNjb3BlJywgJyRsb2NhdGlvbicsICdBdXRoU2VydmljZSddO1xyXG4gICAgZnVuY3Rpb24gUm91dGVJbnRlcmNlcHRvcigkcm9vdFNjb3BlLCAkbG9jYXRpb24sIEF1dGhTZXJ2aWNlKSB7XHJcbiAgICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKGV2ZW50LCBuZXh0LCBjdXJyZW50KSB7XHJcbiAgICAgICAgICAgIC8vanNoaW50IGRlYnVnOiB0cnVlXHJcbiAgICAgICAgICAgIGRlYnVnZ2VyO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQgKyAnIDogJyArIG5leHQuJCRyb3V0ZS5vcmlnaW5hbFBhdGgpO1xyXG4gICAgICAgICAgICBpZiAoIUF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCAmJiBuZXh0LiQkcm91dGUub3JpZ2luYWxQYXRoICE9ICcvbG9naW4nKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbmVlZCBhdXRoJyk7XHJcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2xvZ2luJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5hdXRoJylcclxuICAgICAgICAuZmFjdG9yeSgnQXV0aFNlcnZpY2UnLCBBdXRoU2VydmljZSlcclxuICAgICAgICAuZmFjdG9yeSgnQXV0aFJlc291cmNlJywgQXV0aFJlc291cmNlKTtcclxuXHJcbiAgICBBdXRoU2VydmljZS4kaW5qZWN0ID0gWydBdXRoUmVzb3VyY2UnLCAnJGh0dHAnLCAnJGh0dHBQYXJhbVNlcmlhbGl6ZXInLCAnJGNvb2tpZXMnLCAnJHJvb3RTY29wZSddO1xyXG4gICAgZnVuY3Rpb24gQXV0aFNlcnZpY2UoQXV0aFJlc291cmNlLCAkaHR0cCwgJGh0dHBQYXJhbVNlcmlhbGl6ZXIsICRjb29raWVzLCAkcm9vdFNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgICBzZWxmLmlzQXV0aGVudGljYXRlZCA9IGZhbHNlO1xyXG4gICAgICAgIHNlbGYubG9naW4gPSBsb2dpbjtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbG9naW4oZW1haWwsIHBhc3N3b3JkKSB7XHJcbiAgICAgICAgICAgIEF1dGhSZXNvdXJjZS5hdXRoKCRodHRwUGFyYW1TZXJpYWxpemVyKFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAndWknLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiBlbWFpbCxcclxuICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmQsXHJcbiAgICAgICAgICAgICAgICAgICAgZ3JhbnRfdHlwZTogJ3Bhc3N3b3JkJ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApKS4kcHJvbWlzZS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vbi5BdXRob3JpemF0aW9uID0gJ0JlYXJlciAnICsgZGF0YS5hY2Nlc3NfdG9rZW47XHJcbiAgICAgICAgICAgICAgICAkY29va2llcy5wdXQoXCJhY2Nlc3NfdG9rZW5cIiwgZGF0YS5hY2Nlc3NfdG9rZW4pO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5pc0F1dGhlbnRpY2F0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdvYXV0aDpsb2dpbicsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuaXNBdXRoZW50aWNhdGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRlbWl0KCdvYXV0aDpsb2dpbicpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBzZWxmO1xyXG4gICAgfVxyXG5cclxuICAgIEF1dGhSZXNvdXJjZS4kaW5qZWN0ID0gWyckcmVzb3VyY2UnXTtcclxuICAgIGZ1bmN0aW9uIEF1dGhSZXNvdXJjZSgkcmVzb3VyY2UpIHtcclxuICAgICAgICByZXR1cm4gJHJlc291cmNlKCcvYXBpL2F1dGgvOnBhdGgvOnRva2VuJywge30sIHtcclxuICAgICAgICAgICAgJ2F1dGgnOiB7XHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJywgcGFyYW1zOiB7cGF0aDogJ29hdXRoJywgdG9rZW46ICd0b2tlbid9LCBpc0FycmF5OiBmYWxzZSwgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogJ0Jhc2ljIFluSnZkM05sY2pvPScsXHJcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9dXRmLTgnXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgYW5ndWxhci5tb2R1bGUoJ0NvbnRlbnRNb2R1bGUnKS5mYWN0b3J5KCdDb250ZW50UmVzb3VyY2UnLCBDb250ZW50UmVzb3VyY2UpO1xyXG5cclxuICAgIENvbnRlbnRSZXNvdXJjZS4kaW5qZWN0ID0gWyckcmVzb3VyY2UnXTtcclxuICAgIGZ1bmN0aW9uIENvbnRlbnRSZXNvdXJjZSgkcmVzb3VyY2UpIHtcclxuICAgICAgICByZXR1cm4gJHJlc291cmNlKCdhcGkvY29udGVudC97aWR9Jyk7XHJcbiAgICB9XHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgZ29vZGwgb24gMy85LzIwMTYuXHJcbiAqL1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnQ29udGVudFNlcnZpY2VzJywgWyduZ1Jlc291cmNlJ10pXHJcbiAgICAgICAgLmZhY3RvcnkoJ0NvbnRlbnRTZXJ2aWNlJywgQ29udGVudFNlcnZpY2UpO1xyXG5cclxuICAgIENvbnRlbnRTZXJ2aWNlLiRpbmplY3QgPSBbJyRyZXNvdXJjZSddO1xyXG4gICAgZnVuY3Rpb24gQ29udGVudFNlcnZpY2UoJHJlc291cmNlKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBDb250ZW50ID0gJHJlc291cmNlKCcvYXBpL2NvbnRlbnQvcmVzb3VyY2UnLCB7fSwge30pO1xyXG4gICAgICAgIHNlbGYuZmluZENvbnRlbnQgPSBmaW5kQ29udGVudDtcclxuICAgICAgICBzZWxmLmNyZWF0ZUNvbnRlbnQgPSBjcmVhdGVDb250ZW50O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBmaW5kQ29udGVudChuYW1lLCB0eXBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBDb250ZW50LnF1ZXJ5KHtuYW1lOiBuYW1lLCB0eXBlOiB0eXBlfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVDb250ZW50KGNvbnRlbnREYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnRlbnREYXRhLnR5cGUgPSAnZmlsbSc7XHJcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gbmV3IENvbnRlbnQoY29udGVudERhdGEpO1xyXG4gICAgICAgICAgICBjb250ZW50LiRzYXZlKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBjb250ZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gc2VsZjtcclxuICAgIH1cclxufSkoKTtcclxuIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgZ29vZGwgb24gMy8xMy8yMDE2LlxyXG4gKi9cclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdDb250ZW50Q2FyZE1vZHVsZScsIFtdKTtcclxuICAgIFxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ0NvbnRlbnRDYXJkTW9kdWxlJylcclxuICAgICAgICAuY29uZmlnKFJvdXRlQ29uZmlnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdGaWxtQ2FyZEN0cmwnLCBGaWxtQ2FyZEN0cmwpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1NlcmlhbENhcmRDdHJsJywgU2VyaWFsQ2FyZEN0cmwpO1xyXG5cclxuICAgIGZ1bmN0aW9uIFJvdXRlQ29uZmlnKCRyb3V0ZVByb3ZpZGVyKSB7XHJcbiAgICAgICAgXCJuZ0luamVjdFwiO1xyXG4gICAgICAgICRyb3V0ZVByb3ZpZGVyLndoZW4oJy9maWxtLzpjb250ZW50X2lkJywge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hcHAvY29udGVudC1jYXJkL2NvbnRlbnQtY2FyZC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0ZpbG1DYXJkQ3RybCdcclxuICAgICAgICB9KS53aGVuKCcvc2VyaWFsLzpjb250ZW50X2lkJywge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hcHAvY29udGVudC1jYXJkL2NvbnRlbnQtY2FyZC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1NlcmlhbENhcmRDdHJsJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIEZpbG1DYXJkQ3RybCgpIHtcclxuICAgICAgICBcIm5nSW5qZWN0XCI7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gU2VyaWFsQ2FyZEN0cmwoKSB7XHJcbiAgICAgICAgXCJuZ0luamVjdFwiO1xyXG4gICAgfVxyXG4gICAgXHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgZ29vZGwgb24gNC8yLzIwMTYuXHJcbiAqL1xyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnQ29udHJvbHNNb2R1bGUnLCBbXHJcbiAgICAgICAgJ2NvbnRyb2wuaW5wdXQtY29udHJvbCcsIFxyXG4gICAgICAgICdjb250cm9sLnBhcnNlcicsXHJcbiAgICAgICAgJ2NvbnRyb2wuaW5wdXQtY2h1bmsnXHJcbiAgICBdKTtcclxufSkoKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBnb29kbCBvbiAzLzkvMjAxNi5cclxuICovXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnSXRlbU1vZHVsZScsIFtdKVxyXG4gICAgICAgIC5kaXJlY3RpdmUoJ2NvbnRlbnRJdGVtJywgY29udGVudEl0ZW0pO1xyXG5cclxuICAgIGNvbnRlbnRJdGVtLiRpbmplY3QgPSBbJyRsb2NhdGlvbiddO1xyXG4gICAgZnVuY3Rpb24gY29udGVudEl0ZW0oJGxvY2F0aW9uKSB7XHJcbiAgICAgICAgXCJuZ0luamVjdFwiO1xyXG4gICAgICAgIGZ1bmN0aW9uIGxpbmtlcihzY29wZSwgZWxlbWVudCwgYXR0cikge1xyXG4gICAgICAgICAgICBlbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIgKyBhbmd1bGFyLmxvd2VyY2FzZShzY29wZS5pdGVtLnR5cGUpICtcIi9cIiArIHNjb3BlLml0ZW0uaWQpO1xyXG4gICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBsaW5rOiBsaW5rZXIsXHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICAgICAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtOiAnPSdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXBwL2l0ZW0vaXRlbS5odG1sJ1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgZ29vZGwgb24gMy8yMS8yMDE2LlxyXG4gKi9cclxuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIFxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ1Byb2ZpbGVNb2R1bGUnLCBbXSk7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnUHJvZmlsZU1vZHVsZScpLmNvbmZpZyhSb3V0ZUNvbmZpZyk7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnUHJvZmlsZU1vZHVsZScpLnJ1bihQcm9maWxlQ29uZmlnKTtcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdQcm9maWxlTW9kdWxlJykuY29udHJvbGxlcignUHJvZmlsZUN0cmwnLCBQcm9maWxlQ3RybCk7XHJcblxyXG4gICAgZnVuY3Rpb24gUm91dGVDb25maWcoJHJvdXRlUHJvdmlkZXIpIHtcclxuICAgICAgICBcIm5nSW5qZWN0XCI7XHJcbiAgICAgICAgJHJvdXRlUHJvdmlkZXIud2hlbignL3Byb2ZpbGUnLCB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2FwcC9wcm9maWxlL3Byb2ZpbGUuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlQ3RybCdcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZnVuY3Rpb24gUHJvZmlsZUNvbmZpZygkcm9vdFNjb3BlKSB7XHJcbiAgICAgICAgJHJvb3RTY29wZS5wcm9maWxlID0ge2xvZ2luOiBcIkJyYWlkbmVyXCIsIHBlcm1zOiBbJ3VzZXI6ZWRpdDpwcm9maWxlJ119O1xyXG4gICAgICAgICRyb290U2NvcGUuaGFzUGVybWlzc2lvbiA9IGhhc1Blcm1pc3Npb247XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGhhc1Blcm1pc3Npb24ocGVybSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcHJvZmlsZS5wZXJtcy5pbmRleE9mKHBlcm0pID4gLTE7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIFByb2ZpbGVDdHJsKCkge1xyXG4gICAgfVxyXG4gICAgXHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgQnJhaWRuZXJcclxuICovXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ1JlY2VudE1vZHVsZScsIFtdKVxyXG4gICAgICAgIC5jb250cm9sbGVyKFwiUmVjZW50Q3RybFwiLCBSZWNlbnRDdHJsKTtcclxuXHJcbiAgICBSZWNlbnRDdHJsLiRpbmplY3QgPSBbJyRzY29wZSddO1xyXG4gICAgZnVuY3Rpb24gUmVjZW50Q3RybCgkc2NvcGUpIHtcclxuICAgICAgICAkc2NvcGUuY29udGVudCA9IFtcclxuICAgICAgICAgICAge25hbWU6ICdab290b3BpYScsIHBvc3RlcjogJ2h0dHA6Ly93d3cua2lub3BvaXNrLnJ1L2ltYWdlcy9maWxtX2JpZy83NzUyNzYuanBnJywgaWQ6IDAsIHR5cGU6ICdmaWxtJ30sXHJcbiAgICAgICAgICAgIHtuYW1lOiAnQmF0bWFuIHYgU3VwZXJtYW46IERhd24gb2YgSnVzdGljZScsIHBvc3RlcjogJ2h0dHA6Ly93d3cua2lub3BvaXNrLnJ1L2ltYWdlcy9maWxtX2JpZy83NzA2MzEuanBnJywgaWQ6IDAsIHR5cGU6ICdmaWxtJ30sXHJcbiAgICAgICAgICAgIHtuYW1lOiAnVGhlIEp1c3RpY2UgTGVhZ3VlIFBhcnQgT25lJywgcG9zdGVyOiAnaHR0cDovL3d3dy5raW5vcG9pc2sucnUvaW1hZ2VzL2ZpbG1fYmlnLzQyNDk5NC5qcGcnLCBpZDogMCwgdHlwZTogJ2ZpbG0nfSxcclxuICAgICAgICAgICAge25hbWU6ICdUaGUgZmxhc2gnLCBwb3N0ZXI6ICdodHRwOi8vd3d3Lmtpbm9wb2lzay5ydS9pbWFnZXMvZmlsbV9iaWcvODE3NTA2LmpwZycsIGlkOiAwLCB0eXBlOiAnZmlsbSd9LFxyXG4gICAgICAgICAgICB7bmFtZTogJ1RoZSBKdXN0aWNlIExlYWd1ZSBQYXJ0IE9uZScsIHBvc3RlcjogJ2h0dHA6Ly93d3cua2lub3BvaXNrLnJ1L2ltYWdlcy9maWxtX2JpZy80MjQ5OTQuanBnJywgaWQ6IDAsIHR5cGU6ICdmaWxtJ30sXHJcbiAgICAgICAgICAgIHtuYW1lOiAnRnJvemVuJywgcG9zdGVyOiAnaHR0cDovL3d3dy5raW5vcG9pc2sucnUvaW1hZ2VzL2ZpbG1fYmlnLzQ5MzIwOC5qcGcnLCBpZDogMCwgdHlwZTogJ2ZpbG0nfSxcclxuICAgICAgICAgICAge25hbWU6ICdCYXRtYW4gdiBTdXBlcm1hbjogRGF3biBvZiBKdXN0aWNlJywgcG9zdGVyOiAnaHR0cDovL3d3dy5raW5vcG9pc2sucnUvaW1hZ2VzL2ZpbG1fYmlnLzc3MDYzMS5qcGcnLCBpZDogMCwgdHlwZTogJ2ZpbG0nfSxcclxuICAgICAgICAgICAge25hbWU6ICdVbnRpdGxlZCBTcGlkZXItTWFuIFJlYm9vdCcsIHBvc3RlcjogJ2h0dHA6Ly93d3cua2lub3BvaXNrLnJ1L2ltYWdlcy9maWxtX2JpZy82OTA1OTMuanBnJywgaWQ6IDAsIHR5cGU6ICdmaWxtJ31cclxuICAgICAgICBdO1xyXG4gICAgfVxyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdSZWNlbnRNb2R1bGUnKS5kaXJlY3RpdmUoJ293bENhcm91c2VsJywgZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICB2YXIgbGlua2VyID0gZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgbG9hZENhcm91c2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5vd2xDYXJvdXNlbChcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvb3A6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYXY6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zaXZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxMjAwOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IDZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA5OTI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtczogNFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDc2ODoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zOiAzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgNDc5OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IDJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGF0dHIub3dsQ2Fyb3VzZWwsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGxvYWRDYXJvdXNlbCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6IFwiQVwiLFxyXG4gICAgICAgICAgICBsaW5rOiBsaW5rZXJcclxuICAgICAgICB9O1xyXG5cclxuICAgIH0pO1xyXG59KSgpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IFVzZXIgb24gMTUuMDYuMjAxNi5cclxuICovXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnVXBsb2FkTW9kdWxlJykuY29udHJvbGxlcignVXBsb2FkQ3RybCcsIFVwbG9hZEN0cmwpO1xyXG5cclxuICAgIFVwbG9hZEN0cmwuJGluamVjdCA9IFsnVXBsb2FkRGF0YScsICdDb250ZW50U2VydmljZScsICdVcGxvYWQnLCAnJGNvb2tpZXMnXTtcclxuICAgIGZ1bmN0aW9uIFVwbG9hZEN0cmwoVXBsb2FkRGF0YSwgQ29udGVudFNlcnZpY2UsIFVwbG9hZCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBzZWxmLnVwbG9hZEZpbGUgPSB7fTtcclxuICAgICAgICBzZWxmLmNvbnRlbnQgPSB7fTtcclxuICAgICAgICBzZWxmLnNhdmUgPSBzYXZlO1xyXG4gICAgICAgIHZhciBjb250ZW50ID0gVXBsb2FkRGF0YS5nZXQoKTtcclxuICAgICAgICBVcGxvYWREYXRhLnNldChudWxsKTtcclxuICAgICAgICBpZiAoY29udGVudCkge1xyXG4gICAgICAgICAgICBzZWxmLmNvbnRlbnQgPSBjb250ZW50O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2F2ZSgpIHtcclxuICAgICAgICAgICAgLy9qc2hpbnQgZGVidWc6IHRydWVcclxuICAgICAgICAgICAgZGVidWdnZXI7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGYuY29udGVudCk7XHJcbiAgICAgICAgICAgIHNlbGYuY29udGVudC50eXBlID0gJ2ZpbG0nO1xyXG5cclxuICAgICAgICAgICAgc2VsZi51cGxvYWRGaWxlLnVwbG9hZCA9IFVwbG9hZC51cGxvYWQoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2FwaS9jb250ZW50L3Jlc291cmNlJyxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtjb250ZW50OiBKU09OLnN0cmluZ2lmeShjb250ZW50KSwgZmlsZTogc2VsZi51cGxvYWRGaWxlfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHNlbGYudXBsb2FkRmlsZS51cGxvYWQudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYudXBsb2FkRmlsZS5yZXN1bHQgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPiAwKVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLnN0YXR1cyArICc6ICcgKyByZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgICAgICAgICAgICAgLy8gTWF0aC5taW4gaXMgdG8gZml4IElFIHdoaWNoIHJlcG9ydHMgMjAwJSBzb21ldGltZXNcclxuICAgICAgICAgICAgICAgIHNlbGYudXBsb2FkRmlsZS5wcm9ncmVzcyA9IE1hdGgubWluKDEwMCwgcGFyc2VJbnQoMTAwLjAgKiBldnQubG9hZGVkIC8gZXZ0LnRvdGFsKSk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnUHJvZ3Jlc3M6ICcgKyBNYXRoLm1pbigxMDAsIHBhcnNlSW50KDEwMC4wICogZXZ0LmxvYWRlZCAvIGV2dC50b3RhbCkpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIENvbnRlbnRTZXJ2aWNlLmNyZWF0ZUNvbnRlbnQoc2VsZi5jb250ZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIFxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ1VwbG9hZE1vZHVsZScpXHJcbiAgICAgICAgLmZhY3RvcnkoJ1VwbG9hZERhdGEnLCBVcGxvYWREYXRhKTtcclxuXHJcbiAgICBmdW5jdGlvbiBVcGxvYWREYXRhKCkge1xyXG4gICAgICAgIHZhciB1cGxvYWREYXRhID0ge307XHJcbiAgICAgICAgZnVuY3Rpb24gc2V0KGRhdGEpIHtcclxuICAgICAgICAgICAgdXBsb2FkRGF0YSA9IGRhdGE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGdldCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHVwbG9hZERhdGE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzZXQ6IHNldCxcclxuICAgICAgICAgICAgZ2V0OiBnZXRcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgXHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgVXNlciBvbiAxNS4wNi4yMDE2LlxyXG4gKi9cclxuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdVcGxvYWRNb2R1bGUnKS5jb25maWcoUm91dGVDb25maWcpO1xyXG5cclxuICAgIFJvdXRlQ29uZmlnLiRpbmplY3QgPSBbJyRyb3V0ZVByb3ZpZGVyJ107XHJcbiAgICBmdW5jdGlvbiBSb3V0ZUNvbmZpZygkcm91dGVQcm92aWRlcikge1xyXG4gICAgICAgICRyb3V0ZVByb3ZpZGVyLndoZW4oJy91cGxvYWQnLCB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2FwcC91cGxvYWQvdXBsb2FkLmh0bWwnXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxufSkoKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBVc2VyIG9uIDE1LjA2LjIwMTYuXHJcbiAqL1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgYW5ndWxhci5tb2R1bGUoJ1VwbG9hZE1vZHVsZScpLnNlcnZpY2UoJ1VwbG9hZFNlcnZpY2UnLCBVcGxvYWRTZXJ2aWNlKTtcclxuXHJcbiAgICBVcGxvYWRTZXJ2aWNlLiRpbmplY3QgPSBbJ1VwbG9hZERhdGEnLCAnQ29udGVudFJlc291cmNlJ107XHJcbiAgICBmdW5jdGlvbiBVcGxvYWRTZXJ2aWNlKHVwbG9hZERhdGEsIENvbnRlbnRSZXNvdXJjZSkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgc2VsZi5jcmVhdGVDb250ZW50ID0gY3JlYXRlQ29udGVudDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlQ29udGVudCgpIHtcclxuICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSB1cGxvYWREYXRhLmdldCgpO1xyXG4gICAgICAgICAgICB2YXIgY3JlYXRlZENvbnRlbnQgPSBuZXcgQ29udGVudFJlc291cmNlKGNvbnRlbnQpO1xyXG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlZENvbnRlbnQuaWQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gc2VsZjtcclxuICAgIH1cclxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2NvbnRyb2wuaW5wdXQtY2h1bmsnLCBbXSk7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnY29udHJvbC5pbnB1dC1jaHVuaycpXHJcbiAgICAgICAgLmRpcmVjdGl2ZSgnbG1JbnB1dENodW5rJywgaW5wdXRDaHVuayk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgZnVuY3Rpb24gaW5wdXRDaHVuaygpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzY29wZToge1xyXG4gICAgICAgICAgICAgICAgYmluZE1vZGVsOic9bmdNb2RlbCdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxyXG4gICAgICAgICAgICAvLyByZXBsYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxyXG4gICAgICAgICAgICAndGVtcGxhdGVVcmwnOiAnL2FwcC9jb250cm9sL2lucHV0LWNodW5rL2lucHV0LWNodW5rLmh0bWwnLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW0sIGF0dHIsIG5nTW9kZWwpIHtcclxuICAgICAgICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufSkoKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBLdXpuZXRzb3ZORSBvbiAwNC4wNC4yMDE2LlxyXG4gKi9cclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdjb250cm9sLnBhcnNlcicsIFsnbmdSZXNvdXJjZSddKTtcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnQ29udHJvbHNNb2R1bGUnKVxyXG4gICAgICAgIC5kaXJlY3RpdmUoJ2xtVXJsUGFyc2VyJywgbG1VcmxQYXJzZXIpXHJcbiAgICAgICAgLmZhY3RvcnkoJ0Rpc2NvdmVyeVJlc291cmNlJywgRGlzY292ZXJ5UmVzb3VyY2UpO1xyXG5cclxuICAgIGxtVXJsUGFyc2VyLiRpbmplY3QgPSBbJyRsb2NhdGlvbicsICdVcGxvYWREYXRhJywgJ0Rpc2NvdmVyeVJlc291cmNlJ107XHJcbiAgICBmdW5jdGlvbiBsbVVybFBhcnNlcigkbG9jYXRpb24sIFVwbG9hZERhdGEsIERpc2NvdmVyeVJlc291cmNlKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc2NvcGU6IHtcclxuICAgICAgICAgICAgICAgIGJpbmRNb2RlbDonPW5nTW9kZWwnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcclxuICAgICAgICAgICAgLy8gcmVwbGFjZTogdHJ1ZSxcclxuICAgICAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcclxuICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJzogJy9hcHAvY29udHJvbC91cmwtcGFyc2VyLWNvbnRyb2wvdXJsLXBhcnNlci1jb250cm9sLmh0bWwnLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW0sIGF0dHIsIG5nTW9kZWwpIHtcclxuICAgICAgICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgICAgICAgICAgICAgZWxlbS5maW5kKCcuYnV0dG9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIERpc2NvdmVyeVJlc291cmNlLmdldCh7aWQ6IHNjb3BlLmJpbmRNb2RlbC5tYXRjaCgvXFwvZmlsbVxcLyhcXGQqKVxcLy8pWzFdfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLiRwcm9taXNlLnRoZW4oZnVuY3Rpb24gKHJlc3BvbmNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbmNlLnVybCA9IHNjb3BlLmJpbmRNb2RlbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgVXBsb2FkRGF0YS5zZXQocmVzcG9uY2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3VwbG9hZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIERpc2NvdmVyeVJlc291cmNlLiRpbmplY3QgPSBbJyRyZXNvdXJjZSddO1xyXG4gICAgZnVuY3Rpb24gRGlzY292ZXJ5UmVzb3VyY2UoJHJlc291cmNlKSB7XHJcbiAgICAgICAgcmV0dXJuICRyZXNvdXJjZSgnL2FwaS9jb250ZW50L2Rpc2NvdmVyeS86aWQnKTtcclxuICAgIH1cclxuXHJcbn0pKCk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
